var ACDesigner=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./src/adaptivecards-designer.ts")}({"../adaptivecards-controls/lib/adaptivecards-controls.js":
/*!***************************************************************!*\
  !*** ../adaptivecards-controls/lib/adaptivecards-controls.js ***!
  \***************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||exports.hasOwnProperty(p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(/*! ./constants */"../adaptivecards-controls/lib/constants.js"),exports),__exportStar(__webpack_require__(/*! ./enums */"../adaptivecards-controls/lib/enums.js"),exports),__exportStar(__webpack_require__(/*! ./utils */"../adaptivecards-controls/lib/utils.js"),exports),__exportStar(__webpack_require__(/*! ./collection */"../adaptivecards-controls/lib/collection.js"),exports),__exportStar(__webpack_require__(/*! ./inputcontrol */"../adaptivecards-controls/lib/inputcontrol.js"),exports),__exportStar(__webpack_require__(/*! ./inputwithpopup */"../adaptivecards-controls/lib/inputwithpopup.js"),exports),__exportStar(__webpack_require__(/*! ./calendar */"../adaptivecards-controls/lib/calendar.js"),exports),__exportStar(__webpack_require__(/*! ./dropdown */"../adaptivecards-controls/lib/dropdown.js"),exports),__exportStar(__webpack_require__(/*! ./datepicker */"../adaptivecards-controls/lib/datepicker.js"),exports),__exportStar(__webpack_require__(/*! ./checkbox */"../adaptivecards-controls/lib/checkbox.js"),exports),__exportStar(__webpack_require__(/*! ./radiobutton */"../adaptivecards-controls/lib/radiobutton.js"),exports),__exportStar(__webpack_require__(/*! ./textbox */"../adaptivecards-controls/lib/textbox.js"),exports),__exportStar(__webpack_require__(/*! ./popupmenu */"../adaptivecards-controls/lib/popupmenu.js"),exports)},"../adaptivecards-controls/lib/calendar.js":
/*!*************************************************!*\
  !*** ../adaptivecards-controls/lib/calendar.js ***!
  \*************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Calendar=exports.DayCell=void 0;var Utils=__webpack_require__(/*! ./utils */"../adaptivecards-controls/lib/utils.js"),Constants=__webpack_require__(/*! ./constants */"../adaptivecards-controls/lib/constants.js"),inputcontrol_1=__webpack_require__(/*! ./inputcontrol */"../adaptivecards-controls/lib/inputcontrol.js"),DayCell=function(){function DayCell(date){this._isSubdued=!1,this._isSelected=!1,this.date=date}return DayCell.prototype.selected=function(){this.onSelected&&this.onSelected(this)},DayCell.prototype.render=function(){var _this=this;return this._element=document.createElement("div"),this._element.className="ms-ctrl ms-ctrl-calendarDay",this._element.innerText=this.date.getDate().toString(),this._element.tabIndex=0,this._element.onclick=function(e){_this.selected()},this._element.onkeydown=function(e){if(e.keyCode==Constants.KEY_ENTER)return _this.selected(),!1},this._element},DayCell.prototype.focus=function(){this._element.focus()},Object.defineProperty(DayCell.prototype,"isSubdued",{get:function(){return this._isSubdued},set:function(value){this._isSubdued=value,this._isSubdued?this._element.classList.add("subdued"):this._element.classList.remove("subdued")},enumerable:!1,configurable:!0}),Object.defineProperty(DayCell.prototype,"isSelected",{get:function(){return this._isSelected},set:function(value){this._isSelected=value,this._isSelected?this._element.classList.add("selected"):this._element.classList.remove("selected")},enumerable:!1,configurable:!0}),DayCell}();exports.DayCell=DayCell;var Calendar=function(_super){function Calendar(){var _this=_super.call(this)||this;_this._selectedDay=null,_this._miniCalendarElement=document.createElement("table"),_this._miniCalendarElement.className="ms-ctrl ms-ctrl-slide",_this._miniCalendarElement.cellPadding="0px",_this._miniCalendarElement.cellSpacing="0px";var miniCalendarHeader=document.createElement("div");miniCalendarHeader.className="ms-ctrl ms-ctrl-calendarHeader",miniCalendarHeader.style.display="flex",_this._monthYearLabelElement=document.createElement("div"),_this._monthYearLabelElement.style.flex="1 1 100%",miniCalendarHeader.appendChild(_this._monthYearLabelElement);var navButtons=document.createElement("div");navButtons.style.flex="0 0 auto";var button=document.createElement("i");return button.className="ms-icon ms-ctrl-calendarNavButton ms-icon-chevronLeft",button.tabIndex=0,button.onclick=function(e){_this.date=Utils.addMonths(_this.date,-1)},button.onkeydown=function(e){if(e.keyCode==Constants.KEY_ENTER)return _this.date=Utils.addMonths(_this.date,-1),!1},navButtons.appendChild(button),(button=document.createElement("i")).className="ms-icon ms-ctrl-calendarNavButton ms-icon-chevronRight",button.tabIndex=0,button.onclick=function(e){_this.date=Utils.addMonths(_this.date,1)},button.onkeydown=function(e){if(e.keyCode==Constants.KEY_ENTER)return _this.date=Utils.addMonths(_this.date,1),!1},navButtons.appendChild(button),miniCalendarHeader.appendChild(navButtons),_this._rootContainerElement=document.createElement("div"),_this._rootContainerElement.className="ms-ctrl ms-ctrl-calendar",_this._rootContainerElement.appendChild(miniCalendarHeader),_this._rootContainerElement.appendChild(_this._miniCalendarElement),_this.date=new Date,_this}return __extends(Calendar,_super),Calendar.prototype.generateDayCells=function(baseDate){var _this=this;this._days=[];var inputMonth=baseDate.getMonth(),inputYear=baseDate.getFullYear(),start=new Date(inputYear,inputMonth,1),end=new Date(inputYear,inputMonth,Utils.daysInMonth(inputYear,inputMonth)),startDateDayOfWeek=start.getDay();startDateDayOfWeek-Utils.CalendarSettings.firstDayOfWeek>0&&(start=Utils.addDays(start,Utils.CalendarSettings.firstDayOfWeek-startDateDayOfWeek));var endDateDayOfWeek=end.getDay(),lastDayOfWeek=Utils.CalendarSettings.firstDayOfWeek+6;lastDayOfWeek-endDateDayOfWeek>0&&(end=Utils.addDays(end,lastDayOfWeek-endDateDayOfWeek));var endDate=end.getDate(),endMonth=end.getMonth(),endYear=end.getFullYear();do{var dayCell=new DayCell(start);dayCell.onSelected=function(clickedCell){_this.selectedDayCell=clickedCell,_this.onDateChanged&&_this.onDateChanged(_this)},this._days.push(dayCell);var done=start.getDate()==endDate&&start.getMonth()==endMonth&&start.getFullYear()==endYear;start=Utils.addDays(start,1)}while(!done)},Object.defineProperty(Calendar.prototype,"selectedDayCell",{get:function(){return this._selectedDay},set:function(value){this._selectedDay&&(this._selectedDay.isSelected=!1),this._selectedDay=value,this._selectedDay&&(this._selectedDay.isSelected=!0,this._date=this._selectedDay.date)},enumerable:!1,configurable:!0}),Calendar.prototype.initializeSelection=function(){if(this._date)for(var i=0;i<this._days.length;i++)if(Utils.areDatesEqual(this._days[i].date,this.date)){this.selectedDayCell=this._days[i];break}},Calendar.prototype.rebuildMiniCalendar=function(newDate,oldDate){this.generateDayCells(newDate);var month=newDate.getMonth();this._miniCalendarElement.innerHTML="",this._miniCalendarElement.classList.remove("ms-ctrl-slide","ms-ctrl-slideLeftToRight","ms-ctrl-slideRightToLeft");for(var row=document.createElement("tr"),dayIndex=Utils.CalendarSettings.firstDayOfWeek,i=0;i<Utils.CalendarSettings.daysInWeek;i++){var cell=document.createElement("td");cell.className="ms-ctrl ms-ctrl-calendarDayHeader",cell.innerText=Utils.CalendarSettings.getInitialDayName(dayIndex),row.appendChild(cell),++dayIndex>=Utils.CalendarSettings.daysInWeek&&(dayIndex=0)}this._miniCalendarElement.appendChild(row);for(var i=0;i<this._days.length;i++){i%7==0&&(row=document.createElement("tr"),this._miniCalendarElement.appendChild(row));var tableCell=document.createElement("td");tableCell.appendChild(this._days[i].render()),this._days[i].date.getMonth()!=month&&(this._days[i].isSubdued=!0),row.appendChild(tableCell)}if(oldDate){var timeDelta=newDate.getTime()-oldDate.getTime();timeDelta>0?this._miniCalendarElement.classList.add("ms-ctrl-slide","ms-ctrl-slideRightToLeft"):timeDelta<0&&this._miniCalendarElement.classList.add("ms-ctrl-slide","ms-ctrl-slideLeftToRight")}},Calendar.prototype.attach=function(rootElement){_super.prototype.attach.call(this,rootElement),rootElement.innerHTML="",rootElement.appendChild(this._rootContainerElement)},Calendar.prototype.focus=function(){this._selectedDay&&this._selectedDay.focus()},Object.defineProperty(Calendar.prototype,"date",{get:function(){return this._date},set:function(value){var rebuildNeeded=!0,timeDelta=0,newDate=value||new Date;this._date&&(rebuildNeeded=!this._days||newDate.getFullYear()!=this._date.getFullYear()||newDate.getMonth()!=this._date.getMonth()),rebuildNeeded&&this.rebuildMiniCalendar(newDate,this._date),this._date=newDate,this.initializeSelection(),this._monthYearLabelElement.innerText=Utils.CalendarSettings.getLongMonthName(this._date.getMonth())+" "+this._date.getFullYear()},enumerable:!1,configurable:!0}),Calendar}(inputcontrol_1.InputControl);exports.Calendar=Calendar},"../adaptivecards-controls/lib/checkbox.js":
/*!*************************************************!*\
  !*** ../adaptivecards-controls/lib/checkbox.js ***!
  \*************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CheckBox=void 0;var Constants=__webpack_require__(/*! ./constants */"../adaptivecards-controls/lib/constants.js"),inputcontrol_1,CheckBox=function(_super){function CheckBox(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._label="",_this._checkboxElement=null,_this._spanElement=null,_this}return __extends(CheckBox,_super),CheckBox.createId=function(){var result=CheckBox.creationIndex;return CheckBox.creationIndex++,result},CheckBox.prototype.changed=function(){this.onChange&&this.onChange(this)},CheckBox.prototype.keyDown=function(e){switch(e.keyCode){case Constants.KEY_ENTER:this.isChecked=!this.isChecked}},CheckBox.prototype.attach=function(rootElement){var _this=this;_super.prototype.attach.call(this,rootElement),rootElement.className="ms-ctrl ms-ctrl-checkbox",rootElement.tabIndex=0;var labelAttribute=rootElement.attributes.label;labelAttribute&&(this._label=labelAttribute.value);var isCheckedAttribute=rootElement.attributes.ischecked;isCheckedAttribute&&(this._isChecked="true"===isCheckedAttribute.value),this._checkboxElement=document.createElement("input"),this._checkboxElement.id="ms-ctrl-checkbox-"+CheckBox.createId(),this._checkboxElement.type="checkbox",this._checkboxElement.style.position="absolute",this._checkboxElement.checked=this.isChecked,this._checkboxElement.onchange=function(e){_this.changed()};var labelElement=document.createElement("label");labelElement.htmlFor=this._checkboxElement.id,this._spanElement=document.createElement("span"),this._spanElement.innerText=this._label,labelElement.appendChild(this._spanElement),rootElement.innerHTML="",rootElement.appendChild(this._checkboxElement),rootElement.appendChild(labelElement)},Object.defineProperty(CheckBox.prototype,"label",{get:function(){return this._label},set:function(value){this._label=value,this._spanElement&&(this._spanElement.innerText=this._label)},enumerable:!1,configurable:!0}),Object.defineProperty(CheckBox.prototype,"isChecked",{get:function(){return this._isChecked},set:function(value){this._isChecked!=value&&(this._isChecked=value,this._checkboxElement&&(this._checkboxElement.checked=this._isChecked),this.changed())},enumerable:!1,configurable:!0}),CheckBox.creationIndex=0,CheckBox}(__webpack_require__(/*! ./inputcontrol */"../adaptivecards-controls/lib/inputcontrol.js").InputControl);exports.CheckBox=CheckBox},"../adaptivecards-controls/lib/collection.js":
/*!***************************************************!*\
  !*** ../adaptivecards-controls/lib/collection.js ***!
  \***************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Collection=void 0;var Collection=function(){function Collection(){this._items=[],this.onItemAdded=null,this.onItemRemoved=null}return Collection.prototype.get=function(index){return this._items[index]},Collection.prototype.add=function(item){this._items.push(item),this.onItemAdded&&this.onItemAdded(item)},Collection.prototype.remove=function(item){var i=this._items.indexOf(item);i>=0&&(this._items=this._items.splice(i,1),this.onItemRemoved&&this.onItemRemoved(item))},Collection.prototype.indexOf=function(item){return this._items.indexOf(item)},Object.defineProperty(Collection.prototype,"length",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),Collection}();exports.Collection=Collection},"../adaptivecards-controls/lib/constants.js":
/*!**************************************************!*\
  !*** ../adaptivecards-controls/lib/constants.js ***!
  \**************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KEY_DELETE=exports.KEY_DOWN=exports.KEY_UP=exports.KEY_SPACE=exports.KEY_ESCAPE=exports.KEY_ENTER=exports.KEY_TAB=void 0,exports.KEY_TAB=9,exports.KEY_ENTER=13,exports.KEY_ESCAPE=27,exports.KEY_SPACE=32,exports.KEY_UP=38,exports.KEY_DOWN=40,exports.KEY_DELETE=46},"../adaptivecards-controls/lib/datepicker.js":
/*!***************************************************!*\
  !*** ../adaptivecards-controls/lib/datepicker.js ***!
  \***************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DatePicker=exports.CalendarPopupControl=void 0;var inputwithpopup_1=__webpack_require__(/*! ./inputwithpopup */"../adaptivecards-controls/lib/inputwithpopup.js"),calendar_1=__webpack_require__(/*! ./calendar */"../adaptivecards-controls/lib/calendar.js"),CalendarPopupControl=function(_super){function CalendarPopupControl(owner){var _this=_super.call(this)||this;return _this._owner=owner,_this}return __extends(CalendarPopupControl,_super),CalendarPopupControl.prototype.renderContent=function(){var _this=this,element=document.createElement("div");return element.className="ms-ctrl ms-calendarPopup",this._calendar=new calendar_1.Calendar,this._calendar.date=this._owner.value,this._calendar.onDateChanged=function(c){_this._owner.value=c.date,_this.closePopup(!1)},this._calendar.attach(element),element},CalendarPopupControl.prototype.focus=function(){this._calendar&&this._calendar.focus()},CalendarPopupControl}(inputwithpopup_1.PopupControl);exports.CalendarPopupControl=CalendarPopupControl;var DatePicker=function(_super){function DatePicker(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DatePicker,_super),DatePicker.prototype.validateRootElement=function(rootElement){if(!(rootElement instanceof HTMLDivElement))throw new Error("DatePicker requires a DIV element as its root.")},DatePicker.prototype.createPopupControl=function(){return new CalendarPopupControl(this)},DatePicker.prototype.getValueAsString=function(){return this.value.toLocaleDateString()},DatePicker.prototype.getCssClassName=function(){return"ms-ctrl ms-ctrl-datePicker"},DatePicker.prototype.getButtonIconCssClassName=function(){return"ms-icon-calendar"},DatePicker.prototype.popup=function(){_super.prototype.popup.call(this),this.isOpen&&this.popupControl.focus()},DatePicker}(inputwithpopup_1.InputWithPopup);exports.DatePicker=DatePicker},"../adaptivecards-controls/lib/dropdown.js":
/*!*************************************************!*\
  !*** ../adaptivecards-controls/lib/dropdown.js ***!
  \*************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DropDown=exports.DropDownPopupControl=exports.DropDownItem=void 0;var Constants=__webpack_require__(/*! ./constants */"../adaptivecards-controls/lib/constants.js"),collection_1=__webpack_require__(/*! ./collection */"../adaptivecards-controls/lib/collection.js"),inputwithpopup_1=__webpack_require__(/*! ./inputwithpopup */"../adaptivecards-controls/lib/inputwithpopup.js"),DropDownItem=function(){function DropDownItem(key,value){this.key=key,this._value=value}return DropDownItem.prototype.click=function(){this.onClick&&this.onClick(this)},DropDownItem.prototype.toString=function(){return this.value},DropDownItem.prototype.render=function(){var _this=this;return this._element||(this._element=document.createElement("span"),this._element.className="ms-ctrl ms-ctrl-dropdown-item",this._element.innerText=this.value,this._element.setAttribute("role","option"),this._element.setAttribute("aria-selected","false"),this._element.onmouseup=function(e){_this.click()},this._element.onkeydown=function(e){e.keyCode===Constants.KEY_ENTER&&(_this.click(),e.cancelBubble=!0)}),this._element},Object.defineProperty(DropDownItem.prototype,"value",{get:function(){return this._value},set:function(newValue){this._value=newValue,this._element&&(this._element.innerText=newValue)},enumerable:!1,configurable:!0}),DropDownItem}();exports.DropDownItem=DropDownItem;var DropDownPopupControl=function(_super){function DropDownPopupControl(owner){var _this=_super.call(this)||this;return _this._renderedItems=[],_this._selectedIndex=-1,_this._owner=owner,_this}return __extends(DropDownPopupControl,_super),DropDownPopupControl.prototype.renderContent=function(){var element=document.createElement("div");element.className="ms-ctrl ms-popup",element.setAttribute("role","listbox");for(var selectedIndex=this._owner.selectedIndex,i=0;i<this._owner.items.length;i++){var renderedItem=this._owner.items.get(i).render();renderedItem.tabIndex=0,element.appendChild(renderedItem),i==selectedIndex&&renderedItem.focus(),this._renderedItems.push(renderedItem)}return element},DropDownPopupControl.prototype.keyDown=function(e){_super.prototype.keyDown.call(this,e);var selectedItemIndex=this._selectedIndex;switch(e.keyCode){case Constants.KEY_TAB:this.closePopup(!0);break;case Constants.KEY_ENTER:this.selectedIndex>=0&&(this._owner.selectedIndex=this.selectedIndex,this.closePopup(!1));break;case Constants.KEY_UP:selectedItemIndex<=0?selectedItemIndex=this._renderedItems.length-1:--selectedItemIndex<0&&(selectedItemIndex=this._renderedItems.length-1),this.selectedIndex=selectedItemIndex,e.cancelBubble=!0;break;case Constants.KEY_DOWN:selectedItemIndex<0?selectedItemIndex=0:++selectedItemIndex>=this._renderedItems.length&&(selectedItemIndex=0),this.selectedIndex=selectedItemIndex,e.cancelBubble=!0}},DropDownPopupControl.prototype.render=function(rootElementBounds){var renderedElement=_super.prototype.render.call(this,rootElementBounds);return renderedElement.style.minWidth=rootElementBounds.width/2+"px",renderedElement},Object.defineProperty(DropDownPopupControl.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(index){index>=0&&index<this._renderedItems.length&&(this._selectedIndex>=0&&this._selectedIndex<this._renderedItems.length&&this._renderedItems[this._selectedIndex].setAttribute("aria-selected","false"),this._renderedItems[index].focus(),this._renderedItems[index].setAttribute("aria-selected","true"),this._selectedIndex=index)},enumerable:!1,configurable:!0}),DropDownPopupControl}(inputwithpopup_1.PopupControl);exports.DropDownPopupControl=DropDownPopupControl;var DropDown=function(_super){function DropDown(){var _this=_super.call(this)||this;return _this._items=new collection_1.Collection,_this._items.onItemAdded=function(item){item.onClick=function(clickedItem){_this.itemClicked(clickedItem)}},_this._items.onItemRemoved=function(item){item.onClick=null},_this}return __extends(DropDown,_super),DropDown.prototype.itemClicked=function(item){this.selectedItem=item,this.closePopup(!1),this.rootElement.focus()},DropDown.prototype.validateRootElement=function(rootElement){if(!(rootElement instanceof HTMLDivElement))throw new Error("DropDown requires a DIV element as its root.")},DropDown.prototype.createPopupControl=function(){return new DropDownPopupControl(this)},DropDown.prototype.getCssClassName=function(){return"ms-ctrl ms-ctrl-dropdown"},DropDown.prototype.attach=function(rootElement){_super.prototype.attach.call(this,rootElement);for(var i=0;i<this.rootElement.children.length;i++){var childElement=this.rootElement.children[i];if("ms-dropdown-item"==childElement.tagName.toLowerCase()){var item=new DropDownItem(childElement.attributes.getNamedItem("key").value,childElement.attributes.getNamedItem("value").value);this._items.add(item)}}var ariaLabelledByIds=[];this.parentLabelId&&ariaLabelledByIds.push(this.parentLabelId),this.labelId&&ariaLabelledByIds.push(this.labelId),ariaLabelledByIds.length>0&&this.rootElement.setAttribute("aria-labelledby",ariaLabelledByIds.join(" "))},DropDown.prototype.popup=function(){_super.prototype.popup.call(this),this.popupControl.selectedIndex=this.selectedIndex},Object.defineProperty(DropDown.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(DropDown.prototype,"selectedItem",{get:function(){return this.value},set:function(newValue){this.value=newValue},enumerable:!1,configurable:!0}),Object.defineProperty(DropDown.prototype,"selectedIndex",{get:function(){return this.items.indexOf(this.value)},set:function(index){index>=0&&this.items.length>index&&(this.selectedItem=this.items.get(index))},enumerable:!1,configurable:!0}),Object.defineProperty(DropDown.prototype,"parentLabelId",{get:function(){return this._parentLabelId},set:function(value){this._parentLabelId=value},enumerable:!1,configurable:!0}),DropDown}(inputwithpopup_1.InputWithPopup);exports.DropDown=DropDown},"../adaptivecards-controls/lib/enums.js":
/*!**********************************************!*\
  !*** ../adaptivecards-controls/lib/enums.js ***!
  \**********************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var DayOfWeek;Object.defineProperty(exports,"__esModule",{value:!0}),exports.DayOfWeek=void 0,function(DayOfWeek){DayOfWeek[DayOfWeek.Sunday=0]="Sunday",DayOfWeek[DayOfWeek.Monday=1]="Monday",DayOfWeek[DayOfWeek.Tuesday=2]="Tuesday",DayOfWeek[DayOfWeek.Wednesday=3]="Wednesday",DayOfWeek[DayOfWeek.Thursday=4]="Thursday",DayOfWeek[DayOfWeek.Friday=5]="Friday",DayOfWeek[DayOfWeek.Saturday=6]="Saturday"}(DayOfWeek=exports.DayOfWeek||(exports.DayOfWeek={}))},"../adaptivecards-controls/lib/inputcontrol.js":
/*!*****************************************************!*\
  !*** ../adaptivecards-controls/lib/inputcontrol.js ***!
  \*****************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InputControl=void 0;var InputControl=function(){function InputControl(){}return InputControl.prototype.validateRootElement=function(rootElement){},InputControl.prototype.keyDown=function(e){},Object.defineProperty(InputControl.prototype,"rootElement",{get:function(){return this._rootElement},enumerable:!1,configurable:!0}),InputControl.prototype.attach=function(rootElement){var _this=this;this.validateRootElement(rootElement),this._rootElement=rootElement,this._rootElement.onkeydown=function(e){_this.keyDown(e)}},InputControl}();exports.InputControl=InputControl},"../adaptivecards-controls/lib/inputwithpopup.js":
/*!*******************************************************!*\
  !*** ../adaptivecards-controls/lib/inputwithpopup.js ***!
  \*******************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.InputWithPopup=exports.PopupControl=void 0;var Constants=__webpack_require__(/*! ./constants */"../adaptivecards-controls/lib/constants.js"),Utils=__webpack_require__(/*! ./utils */"../adaptivecards-controls/lib/utils.js"),inputcontrol_1=__webpack_require__(/*! ./inputcontrol */"../adaptivecards-controls/lib/inputcontrol.js"),uuid_1=__webpack_require__(/*! uuid */"../adaptivecards-controls/node_modules/uuid/index.js"),PopupControl=function(){function PopupControl(){this._isOpen=!1}return PopupControl.prototype.keyDown=function(e){switch(e.keyCode){case Constants.KEY_ESCAPE:this.closePopup(!0)}},PopupControl.prototype.render=function(rootElementBounds){var _this=this,element=document.createElement("div");return element.tabIndex=0,element.className="ms-ctrl ms-ctrl-popup-container",element.setAttribute("role","dialog"),element.setAttribute("aria-modal","true"),element.onkeydown=function(e){return _this.keyDown(e),!e.cancelBubble},element.appendChild(this.renderContent()),element},PopupControl.prototype.focus=function(){this._popupElement&&this._popupElement.firstElementChild.focus()},PopupControl.prototype.popup=function(rootElement){var _this=this;if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className="ms-ctrl-overlay",this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=function(e){_this.closePopup(!0)},document.body.appendChild(this._overlayElement);var rootElementBounds=rootElement.getBoundingClientRect();this._popupElement=this.render(rootElementBounds),this._popupElement.classList.remove("ms-ctrl-slide","ms-ctrl-slideLeftToRight","ms-ctrl-slideRightToLeft","ms-ctrl-slideTopToBottom","ms-ctrl-slideRightToLeft"),window.addEventListener("resize",(function(e){_this.closePopup(!0)}));var rootElementLabel=rootElement.getAttribute("aria-label");rootElementLabel&&this._popupElement.setAttribute("aria-label",rootElementLabel),this._overlayElement.appendChild(this._popupElement);var popupElementBounds=this._popupElement.getBoundingClientRect(),availableSpaceBelow=window.innerHeight-rootElementBounds.bottom,availableSpaceAbove=rootElementBounds.top,availableSpaceRight=window.innerWidth-rootElementBounds.left,availableSpaceRight=window.innerWidth-rootElementBounds.right,availableSpaceLeft=rootElementBounds.left,left=rootElementBounds.left+Utils.getScrollX(),top;if(availableSpaceAbove<popupElementBounds.height&&availableSpaceBelow<popupElementBounds.height){var actualPopupHeight=Math.min(popupElementBounds.height,window.innerHeight);if(this._popupElement.style.maxHeight=actualPopupHeight+"px",top=actualPopupHeight<popupElementBounds.height?Utils.getScrollY():Utils.getScrollY()+rootElementBounds.top+(rootElementBounds.height-actualPopupHeight)/2,availableSpaceLeft<popupElementBounds.width&&availableSpaceRight<popupElementBounds.width){var actualPopupWidth=Math.min(popupElementBounds.width,window.innerWidth);this._popupElement.style.maxWidth=actualPopupWidth+"px",left=actualPopupWidth<popupElementBounds.width?Utils.getScrollX():Utils.getScrollX()+rootElementBounds.left+(rootElementBounds.width-actualPopupWidth)/2}else availableSpaceRight>=popupElementBounds.width?(left=Utils.getScrollX()+rootElementBounds.right,this._popupElement.classList.add("ms-ctrl-slide","ms-ctrl-slideLeftToRight")):(left=Utils.getScrollX()+rootElementBounds.left-popupElementBounds.width,this._popupElement.classList.add("ms-ctrl-slide","ms-ctrl-slideRightToLeft"))}else availableSpaceBelow>=popupElementBounds.height?(top=Utils.getScrollY()+rootElementBounds.bottom,this._popupElement.classList.add("ms-ctrl-slide","ms-ctrl-slideTopToBottom")):(top=Utils.getScrollY()+rootElementBounds.top-popupElementBounds.height,this._popupElement.classList.add("ms-ctrl-slide","ms-ctrl-slideBottomToTop")),availableSpaceRight<popupElementBounds.width&&(left=Utils.getScrollX()+rootElementBounds.right-popupElementBounds.width);this._popupElement.style.left=left+"px",this._popupElement.style.top=top+"px",this._popupElement.focus(),this._isOpen=!0}},PopupControl.prototype.closePopup=function(wasCancelled){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1,this.onClose&&this.onClose(this,wasCancelled))},Object.defineProperty(PopupControl.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!1,configurable:!0}),PopupControl}();exports.PopupControl=PopupControl;var InputWithPopup=function(_super){function InputWithPopup(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(InputWithPopup,_super),InputWithPopup.prototype.keyDown=function(e){switch(e.keyCode){case Constants.KEY_ENTER:this.popup()}},InputWithPopup.prototype.updateLabel=function(){this._labelElement&&(this._value?(this._labelElement.innerHTML=this.getValueAsString(),this._labelElement.classList.remove("placeholder")):(this._labelElement.innerText=this._placeholderText?this._placeholderText:"",this._labelElement.classList.add("placeholder")))},Object.defineProperty(InputWithPopup.prototype,"popupControl",{get:function(){return this._popupControl},enumerable:!1,configurable:!0}),InputWithPopup.prototype.getButtonIconCssClassName=function(){return"ms-icon-chevronDown"},InputWithPopup.prototype.getValueAsString=function(){return this._value.toString()},InputWithPopup.prototype.valueChanged=function(){this.onValueChanged&&this.onValueChanged(this)},InputWithPopup.prototype.attach=function(rootElement){var _this=this;_super.prototype.attach.call(this,rootElement),rootElement.tabIndex=0,rootElement.className=this.getCssClassName(),window.addEventListener("resize",(function(e){_this.closePopup(!0)})),this.rootElement.onclick=function(e){_this.isOpen?_this.closePopup(!0):_this.popup()};var placeHolderDomItem=this.rootElement.attributes.getNamedItem("placeholder");placeHolderDomItem&&(this._placeholderText=placeHolderDomItem.value),this._labelElement=document.createElement("span"),this._labelElement.className="ms-ctrl ms-dropdown-label",this._labelElement.id=uuid_1.v4(),this._dropDownButtonElement=document.createElement("i"),this._dropDownButtonElement.className="ms-icon ms-ctrl-dropdown-button "+this.getButtonIconCssClassName(),this.rootElement.appendChild(this._labelElement),this.rootElement.appendChild(this._dropDownButtonElement),this.updateLabel()},InputWithPopup.prototype.popup=function(){var _this=this;this._popupControl=this.createPopupControl(),this._popupControl.onClose=function(sender,wasCancelled){_this.closePopup(wasCancelled),_this.rootElement.focus()},this._popupControl.popup(this.rootElement)},InputWithPopup.prototype.closePopup=function(wasCancelled){this.popupControl&&this.popupControl.closePopup(wasCancelled)},Object.defineProperty(InputWithPopup.prototype,"labelId",{get:function(){if(this._labelElement)return this._labelElement.id},enumerable:!1,configurable:!0}),Object.defineProperty(InputWithPopup.prototype,"isOpen",{get:function(){return!!this._popupControl&&this._popupControl.isOpen},enumerable:!1,configurable:!0}),Object.defineProperty(InputWithPopup.prototype,"placeholderText",{get:function(){return this._placeholderText},set:function(value){this._placeholderText=value},enumerable:!1,configurable:!0}),Object.defineProperty(InputWithPopup.prototype,"value",{get:function(){return this._value},set:function(newValue){this._value!=newValue&&(this._value=newValue,this.updateLabel(),this.valueChanged())},enumerable:!1,configurable:!0}),InputWithPopup}(inputcontrol_1.InputControl);exports.InputWithPopup=InputWithPopup},"../adaptivecards-controls/lib/popupmenu.js":
/*!**************************************************!*\
  !*** ../adaptivecards-controls/lib/popupmenu.js ***!
  \**************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PopupMenu=void 0;var Constants=__webpack_require__(/*! ./constants */"../adaptivecards-controls/lib/constants.js"),collection_1=__webpack_require__(/*! ./collection */"../adaptivecards-controls/lib/collection.js"),inputwithpopup_1,PopupMenu=function(_super){function PopupMenu(){var _this=_super.call(this)||this;return _this._items=new collection_1.Collection,_this._renderedItems=[],_this._selectedIndex=-1,_this}return __extends(PopupMenu,_super),PopupMenu.prototype.renderContent=function(){var element=document.createElement("div");element.className="ms-ctrl ms-popup",element.setAttribute("role","listbox");for(var i=0;i<this._items.length;i++){var renderedItem=this._items.get(i).render();renderedItem.tabIndex=0,element.appendChild(renderedItem),i==this.selectedIndex&&renderedItem.focus(),this._renderedItems.push(renderedItem)}return element},PopupMenu.prototype.keyDown=function(e){_super.prototype.keyDown.call(this,e);var selectedItemIndex=this._selectedIndex;switch(e.keyCode){case Constants.KEY_TAB:this.closePopup(!0);break;case Constants.KEY_UP:selectedItemIndex<=0?selectedItemIndex=this._renderedItems.length-1:--selectedItemIndex<0&&(selectedItemIndex=this._renderedItems.length-1),this.selectedIndex=selectedItemIndex,e.cancelBubble=!0;break;case Constants.KEY_DOWN:selectedItemIndex<0?selectedItemIndex=0:++selectedItemIndex>=this._renderedItems.length&&(selectedItemIndex=0),this.selectedIndex=selectedItemIndex,e.cancelBubble=!0}},Object.defineProperty(PopupMenu.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(PopupMenu.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(index){index>=0&&index<this._renderedItems.length&&(this._renderedItems[index].focus(),this._selectedIndex=index)},enumerable:!1,configurable:!0}),PopupMenu}(__webpack_require__(/*! ./inputwithpopup */"../adaptivecards-controls/lib/inputwithpopup.js").PopupControl);exports.PopupMenu=PopupMenu},"../adaptivecards-controls/lib/radiobutton.js":
/*!****************************************************!*\
  !*** ../adaptivecards-controls/lib/radiobutton.js ***!
  \****************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RadioButton=void 0;var Constants=__webpack_require__(/*! ./constants */"../adaptivecards-controls/lib/constants.js"),inputcontrol_1,RadioButton=function(_super){function RadioButton(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._label="",_this._checkboxElement=null,_this._spanElement=null,_this}return __extends(RadioButton,_super),RadioButton.createId=function(){var result=RadioButton.creationIndex;return RadioButton.creationIndex++,result},RadioButton.prototype.changed=function(){this.onChange&&this.onChange(this)},RadioButton.prototype.keyDown=function(e){switch(e.keyCode){case Constants.KEY_ENTER:this.isChecked=!this.isChecked}},RadioButton.prototype.attach=function(rootElement){var _this=this;_super.prototype.attach.call(this,rootElement),rootElement.className="ms-ctrl ms-ctrl-radiobutton",rootElement.tabIndex=0;var labelAttribute=rootElement.attributes.label;labelAttribute&&(this._label=labelAttribute.value);var isCheckedAttribute=rootElement.attributes.ischecked;isCheckedAttribute&&(this._isChecked="true"===isCheckedAttribute.value),this._checkboxElement=document.createElement("input"),this._checkboxElement.id="ms-ctrl-radio-"+RadioButton.createId(),this._checkboxElement.type="radio",this._checkboxElement.style.position="absolute",this._checkboxElement.checked=this.isChecked,this._checkboxElement.onchange=function(e){_this.changed()};var groupNameAttribute=rootElement.attributes.groupname;groupNameAttribute&&(this._checkboxElement.name=groupNameAttribute.value);var labelElement=document.createElement("label");labelElement.htmlFor=this._checkboxElement.id,this._spanElement=document.createElement("span"),this._spanElement.innerText=this._label,labelElement.appendChild(this._spanElement),rootElement.innerHTML="",rootElement.appendChild(this._checkboxElement),rootElement.appendChild(labelElement)},Object.defineProperty(RadioButton.prototype,"label",{get:function(){return this._label},set:function(value){this._label=value,this._spanElement&&(this._spanElement.innerText=this._label)},enumerable:!1,configurable:!0}),Object.defineProperty(RadioButton.prototype,"isChecked",{get:function(){return this._isChecked},set:function(value){this._isChecked!=value&&(this._isChecked=value,this._checkboxElement&&(this._checkboxElement.checked=this._isChecked),this.changed())},enumerable:!1,configurable:!0}),RadioButton.creationIndex=0,RadioButton}(__webpack_require__(/*! ./inputcontrol */"../adaptivecards-controls/lib/inputcontrol.js").InputControl);exports.RadioButton=RadioButton},"../adaptivecards-controls/lib/textbox.js":
/*!************************************************!*\
  !*** ../adaptivecards-controls/lib/textbox.js ***!
  \************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),extendStatics;Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextBox=void 0;var Utils=__webpack_require__(/*! ./utils */"../adaptivecards-controls/lib/utils.js"),inputcontrol_1=__webpack_require__(/*! ./inputcontrol */"../adaptivecards-controls/lib/inputcontrol.js"),EditBox=function(){function EditBox(){}return EditBox.prototype.changed=function(){this.onChange&&this.onChange()},EditBox}(),SingleLineEditBox=function(_super){function SingleLineEditBox(){var _this=_super.call(this)||this;return _this._inputElement=document.createElement("input"),_this._inputElement.className="ms-ctrl ms-ctrl-textbox",_this._inputElement.type="text",_this._inputElement.oninput=function(e){_this.changed()},_this}return __extends(SingleLineEditBox,_super),Object.defineProperty(SingleLineEditBox.prototype,"element",{get:function(){return this._inputElement},enumerable:!1,configurable:!0}),Object.defineProperty(SingleLineEditBox.prototype,"placeholder",{set:function(value){this._inputElement.placeholder=value},enumerable:!1,configurable:!0}),Object.defineProperty(SingleLineEditBox.prototype,"lineCount",{set:function(value){},enumerable:!1,configurable:!0}),Object.defineProperty(SingleLineEditBox.prototype,"maxLength",{set:function(value){this._inputElement.maxLength!=value&&(this._inputElement.maxLength=value,this.value=this.value.substr(0,value))},enumerable:!1,configurable:!0}),Object.defineProperty(SingleLineEditBox.prototype,"value",{get:function(){return this._inputElement.value},set:function(newValue){this._inputElement.value=newValue},enumerable:!1,configurable:!0}),SingleLineEditBox}(EditBox),MultilineEditBox=function(_super){function MultilineEditBox(){var _this=_super.call(this)||this;return _this._textareaElement=document.createElement("textarea"),_this._textareaElement.className="ms-ctrl ms-ctrl-textbox ms-ctrl-textbox-multiline",_this._textareaElement.oninput=function(e){_this.changed()},_this}return __extends(MultilineEditBox,_super),Object.defineProperty(MultilineEditBox.prototype,"element",{get:function(){return this._textareaElement},enumerable:!1,configurable:!0}),Object.defineProperty(MultilineEditBox.prototype,"placeholder",{set:function(value){this._textareaElement.placeholder=value},enumerable:!1,configurable:!0}),Object.defineProperty(MultilineEditBox.prototype,"lineCount",{set:function(value){this._textareaElement.rows=value},enumerable:!1,configurable:!0}),Object.defineProperty(MultilineEditBox.prototype,"maxLength",{set:function(value){this._textareaElement.maxLength!=value&&(this._textareaElement.maxLength=value,this.value=this.value.substr(0,value))},enumerable:!1,configurable:!0}),Object.defineProperty(MultilineEditBox.prototype,"value",{get:function(){return this._textareaElement.value},set:function(newValue){this._textareaElement.value=newValue},enumerable:!1,configurable:!0}),MultilineEditBox}(EditBox),TextBox=function(_super){function TextBox(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._isMultiline=!1,_this._lineCount=3,_this}return __extends(TextBox,_super),TextBox.prototype.editBoxChanged=function(){this.onChange&&this.onChange(this)},TextBox.prototype.recreateEditBox=function(){var _this=this,currentValue=null;currentValue=this._editBox?this._editBox.value:this.rootElement.innerText,this._isMultiline?this._editBox=new MultilineEditBox:this._editBox=new SingleLineEditBox,currentValue&&(this._editBox.value=currentValue),this._editBox.lineCount=this._lineCount,this._editBox.maxLength=this._maxLength,this._editBox.placeholder=this._placeholder,this._editBox.onChange=function(){_this.editBoxChanged()},this.rootElement.innerHTML="",this.rootElement.appendChild(this._editBox.element)},Object.defineProperty(TextBox.prototype,"editBox",{get:function(){return this._editBox||this.recreateEditBox(),this._editBox},enumerable:!1,configurable:!0}),TextBox.prototype.attach=function(rootElement){_super.prototype.attach.call(this,rootElement),this._isMultiline=Utils.getAttributeValueAsBool(rootElement,"ismultiline",!1),this._lineCount=Utils.getAttributeValueAsInt(rootElement,"lines",3),this._maxLength=Utils.getAttributeValueAsInt(rootElement,"maxlength",5e4),this._placeholder=Utils.getAttributeValueAsString(rootElement,"placeholder",null),this.recreateEditBox()},Object.defineProperty(TextBox.prototype,"value",{get:function(){return this.editBox.value},set:function(newValue){this.editBox.value=newValue},enumerable:!1,configurable:!0}),Object.defineProperty(TextBox.prototype,"placeholder",{get:function(){return this._placeholder},set:function(value){this._placeholder=value,this.editBox.placeholder=value},enumerable:!1,configurable:!0}),Object.defineProperty(TextBox.prototype,"isMultiline",{get:function(){return this._isMultiline},set:function(value){this._isMultiline!=value&&(this._isMultiline=value,this.recreateEditBox())},enumerable:!1,configurable:!0}),Object.defineProperty(TextBox.prototype,"lineCount",{get:function(){return this._lineCount},set:function(value){value>0&&(this._lineCount=value,this.editBox.lineCount=value)},enumerable:!1,configurable:!0}),Object.defineProperty(TextBox.prototype,"maxLength",{get:function(){return this._maxLength},set:function(value){value>0&&(this._maxLength=value,this.editBox.maxLength=value)},enumerable:!1,configurable:!0}),TextBox}(inputcontrol_1.InputControl);exports.TextBox=TextBox},"../adaptivecards-controls/lib/utils.js":
/*!**********************************************!*\
  !*** ../adaptivecards-controls/lib/utils.js ***!
  \**********************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAttributeValueAsInt=exports.getAttributeValueAsString=exports.getAttributeValueAsBool=exports.getScrollY=exports.getScrollX=exports.areDatesEqual=exports.addMonths=exports.addDays=exports.daysInMonth=exports.CalendarSettings=void 0;var Enums=__webpack_require__(/*! ./enums */"../adaptivecards-controls/lib/enums.js"),CalendarSettings=function(){function CalendarSettings(){}return CalendarSettings.getLongDayName=function(dayIndex){if(dayIndex>=0&&dayIndex<CalendarSettings.longDayNames.length)return CalendarSettings.longDayNames[dayIndex];throw new Error("Day index out of range: "+dayIndex)},CalendarSettings.getShortDayName=function(dayIndex){if(dayIndex>=0&&dayIndex<CalendarSettings.shortDayNames.length)return CalendarSettings.shortDayNames[dayIndex];throw new Error("Day index out of range: "+dayIndex)},CalendarSettings.getInitialDayName=function(dayIndex){if(dayIndex>=0&&dayIndex<CalendarSettings.minimalDayNames.length)return CalendarSettings.minimalDayNames[dayIndex];throw new Error("Day index out of range: "+dayIndex)},CalendarSettings.getLongMonthName=function(monthIndex){if(monthIndex>=0&&monthIndex<CalendarSettings.longMonthNames.length)return CalendarSettings.longMonthNames[monthIndex];throw new Error("Month index out of range: "+monthIndex)},CalendarSettings.getShortMonthName=function(monthIndex){if(monthIndex>=0&&monthIndex<CalendarSettings.shortMonthNames.length)return CalendarSettings.shortMonthNames[monthIndex];throw new Error("Month index out of range: "+monthIndex)},CalendarSettings.monthsInYear=12,CalendarSettings.daysInWeek=7,CalendarSettings.firstDayOfWeek=Enums.DayOfWeek.Sunday,CalendarSettings.longDayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],CalendarSettings.shortDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],CalendarSettings.minimalDayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],CalendarSettings.longMonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],CalendarSettings.shortMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CalendarSettings}();function daysInMonth(year,month){switch(month){case 1:return year%4==0&&year%100||year%400==0?29:28;case 3:case 5:case 8:case 10:return 30;default:return 31}}function addDays(date,days){var result=new Date(date.getTime());return result.setDate(result.getDate()+days),result}function addMonths(date,months){var result=new Date(date.getTime()),newMonth=result.getMonth()+months;return result.setMonth(newMonth),result.getMonth()!==(newMonth%CalendarSettings.monthsInYear+CalendarSettings.monthsInYear)%CalendarSettings.monthsInYear&&(result=addDays(result,-result.getDate())),result}function areDatesEqual(date1,date2){return date1.getFullYear()==date2.getFullYear()&&date1.getMonth()==date2.getMonth()&&date1.getDate()==date2.getDate()}function getScrollX(){return window.pageXOffset}function getScrollY(){return window.pageYOffset}function getAttributeValueAsBool(element,attributeName,defaultValue){var attribute=element.attributes[attributeName];return attribute?"true"===attribute.value:defaultValue}function getAttributeValueAsString(element,attributeName,defaultValue){var attribute=element.attributes[attributeName];return attribute?attribute.value:defaultValue}function getAttributeValueAsInt(element,attributeName,defaultValue){var attribute=element.attributes[attributeName];if(attribute){var n=parseInt(attribute.value);if(!isNaN(n))return n}return defaultValue}exports.CalendarSettings=CalendarSettings,exports.daysInMonth=daysInMonth,exports.addDays=addDays,exports.addMonths=addMonths,exports.areDatesEqual=areDatesEqual,exports.getScrollX=getScrollX,exports.getScrollY=getScrollY,exports.getAttributeValueAsBool=getAttributeValueAsBool,exports.getAttributeValueAsString=getAttributeValueAsString,exports.getAttributeValueAsInt=getAttributeValueAsInt},"../adaptivecards-controls/node_modules/uuid/index.js":
/*!************************************************************!*\
  !*** ../adaptivecards-controls/node_modules/uuid/index.js ***!
  \************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){var v1=__webpack_require__(/*! ./v1 */"../adaptivecards-controls/node_modules/uuid/v1.js"),v4=__webpack_require__(/*! ./v4 */"../adaptivecards-controls/node_modules/uuid/v4.js"),uuid=v4;uuid.v1=v1,uuid.v4=v4,module.exports=uuid},"../adaptivecards-controls/node_modules/uuid/lib/bytesToUuid.js":
/*!**********************************************************************!*\
  !*** ../adaptivecards-controls/node_modules/uuid/lib/bytesToUuid.js ***!
  \**********************************************************************/
/*! no static exports found */function(module,exports){for(var byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);function bytesToUuid(buf,offset){var i=offset||0,bth=byteToHex;return[bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]]].join("")}module.exports=bytesToUuid},"../adaptivecards-controls/node_modules/uuid/lib/rng-browser.js":
/*!**********************************************************************!*\
  !*** ../adaptivecards-controls/node_modules/uuid/lib/rng-browser.js ***!
  \**********************************************************************/
/*! no static exports found */function(module,exports){var getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);module.exports=function whatwgRNG(){return getRandomValues(rnds8),rnds8}}else{var rnds=new Array(16);module.exports=function mathRNG(){for(var i=0,r;i<16;i++)0==(3&i)&&(r=4294967296*Math.random()),rnds[i]=r>>>((3&i)<<3)&255;return rnds}}},"../adaptivecards-controls/node_modules/uuid/v1.js":
/*!*********************************************************!*\
  !*** ../adaptivecards-controls/node_modules/uuid/v1.js ***!
  \*********************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){var rng=__webpack_require__(/*! ./lib/rng */"../adaptivecards-controls/node_modules/uuid/lib/rng-browser.js"),bytesToUuid=__webpack_require__(/*! ./lib/bytesToUuid */"../adaptivecards-controls/node_modules/uuid/lib/bytesToUuid.js"),_nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1(options,buf,offset){var i=buf&&offset||0,b=buf||[],node=(options=options||{}).node||_nodeId,clockseq=void 0!==options.clockseq?options.clockseq:_clockseq;if(null==node||null==clockseq){var seedBytes=rng();null==node&&(node=_nodeId=[1|seedBytes[0],seedBytes[1],seedBytes[2],seedBytes[3],seedBytes[4],seedBytes[5]]),null==clockseq&&(clockseq=_clockseq=16383&(seedBytes[6]<<8|seedBytes[7]))}var msecs=void 0!==options.msecs?options.msecs:(new Date).getTime(),nsecs=void 0!==options.nsecs?options.nsecs:_lastNSecs+1,dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&void 0===options.clockseq&&(clockseq=clockseq+1&16383),(dt<0||msecs>_lastMSecs)&&void 0===options.nsecs&&(nsecs=0),nsecs>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=msecs,_lastNSecs=nsecs,_clockseq=clockseq;var tl=(1e4*(268435455&(msecs+=122192928e5))+nsecs)%4294967296;b[i++]=tl>>>24&255,b[i++]=tl>>>16&255,b[i++]=tl>>>8&255,b[i++]=255&tl;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255,b[i++]=255&tmh,b[i++]=tmh>>>24&15|16,b[i++]=tmh>>>16&255,b[i++]=clockseq>>>8|128,b[i++]=255&clockseq;for(var n=0;n<6;++n)b[i+n]=node[n];return buf||bytesToUuid(b)}module.exports=v1},"../adaptivecards-controls/node_modules/uuid/v4.js":
/*!*********************************************************!*\
  !*** ../adaptivecards-controls/node_modules/uuid/v4.js ***!
  \*********************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){var rng=__webpack_require__(/*! ./lib/rng */"../adaptivecards-controls/node_modules/uuid/lib/rng-browser.js"),bytesToUuid=__webpack_require__(/*! ./lib/bytesToUuid */"../adaptivecards-controls/node_modules/uuid/lib/bytesToUuid.js");function v4(options,buf,offset){var i=buf&&offset||0;"string"==typeof options&&(buf="binary"===options?new Array(16):null,options=null);var rnds=(options=options||{}).random||(options.rng||rng)();if(rnds[6]=15&rnds[6]|64,rnds[8]=63&rnds[8]|128,buf)for(var ii=0;ii<16;++ii)buf[i+ii]=rnds[ii];return buf||bytesToUuid(rnds)}module.exports=v4},"../adaptivecards-templating/lib/adaptivecards-templating.js":
/*!*******************************************************************!*\
  !*** ../adaptivecards-templating/lib/adaptivecards-templating.js ***!
  \*******************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||exports.hasOwnProperty(p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(/*! ./template-engine */"../adaptivecards-templating/lib/template-engine.js"),exports)},"../adaptivecards-templating/lib/template-engine.js":
/*!**********************************************************!*\
  !*** ../adaptivecards-templating/lib/template-engine.js ***!
  \**********************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Template=exports.GlobalSettings=void 0;var AEL=__webpack_require__(/*! adaptive-expressions */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/index.js"),EvaluationContext=function(){function EvaluationContext(context){this._stateStack=[],void 0!==context&&(this.$root=context.$root)}return EvaluationContext.prototype.isReservedField=function(name){return EvaluationContext._reservedFields.indexOf(name)>=0},EvaluationContext.prototype.saveState=function(){this._stateStack.push({$data:this.$data,$index:this.$index})},EvaluationContext.prototype.restoreLastState=function(){if(0===this._stateStack.length)throw new Error("There is no evaluation context state to restore.");var savedContext=this._stateStack.pop();this.$data=savedContext.$data,this.$index=savedContext.$index},Object.defineProperty(EvaluationContext.prototype,"$data",{get:function(){return void 0!==this._$data?this._$data:this.$root},set:function(value){this._$data=value},enumerable:!1,configurable:!0}),EvaluationContext._reservedFields=["$data","$root","$index"],EvaluationContext}(),TemplateObjectMemory=function(){function TemplateObjectMemory(){this._memory=new AEL.SimpleObjectMemory(this)}return TemplateObjectMemory.prototype.getValue=function(path){var actualPath=path.length>0&&"$"!==path[0]?"$data."+path:path;return this._memory.getValue(actualPath)},TemplateObjectMemory.prototype.setValue=function(path,input){this._memory.setValue(path,input)},TemplateObjectMemory.prototype.version=function(){return this._memory.version()},TemplateObjectMemory}(),GlobalSettings=function(){function GlobalSettings(){}return GlobalSettings.getUndefinedFieldValueSubstitutionString=void 0,GlobalSettings}();exports.GlobalSettings=GlobalSettings;var Template=function(){function Template(payload){this._preparedPayload=Template.prepare(payload)}return Template.prepare=function(node){if("string"==typeof node)return Template.parseInterpolatedString(node);if("object"==typeof node&&null!==node){if(Array.isArray(node)){for(var result=[],_i=0,node_1=node;_i<node_1.length;_i++){var item=node_1[_i];result.push(Template.prepare(item))}return result}for(var keys,result={},_a=0,keys_1=Object.keys(node);_a<keys_1.length;_a++){var key=keys_1[_a];result[key]=Template.prepare(node[key])}return result}return node},Template.internalTryEvaluateExpression=function(expression,context,allowSubstitutions){var memory=new TemplateObjectMemory;memory.$root=context.$root,memory.$data=context.$data,memory.$index=context.$index;var options=void 0;if(allowSubstitutions&&((options=new AEL.Options).nullSubstitution=function(path){var substitutionValue=void 0;return GlobalSettings.getUndefinedFieldValueSubstitutionString&&(substitutionValue=GlobalSettings.getUndefinedFieldValueSubstitutionString(path)),substitutionValue||"${"+path+"}"}),expression.type===AEL.ExpressionType.Concat&&allowSubstitutions){for(var result="",_i=0,_a=expression.children;_i<_a.length;_i++){var childExpression=_a[_i],evaluationResult=void 0;try{evaluationResult=childExpression.tryEvaluate(memory,options)}catch(ex){evaluationResult={value:void 0,error:ex}}evaluationResult.error&&(evaluationResult.value="${"+childExpression.toString()+"}"),result+=evaluationResult.value.toString()}return{value:result,error:void 0}}return expression.tryEvaluate(memory,options)},Template.parseInterpolatedString=function(interpolatedString){for(var regExp=/\${([^{}}]+)}/g,matches=null,lastMatch,matchCount=0;matchCount<=1&&null!=(matches=regExp.exec(interpolatedString));)lastMatch=matches,matchCount++;var lookup=function(type){var standardFunction=AEL.ExpressionFunctions.standardFunctions.get(type);return standardFunction||new AEL.ExpressionEvaluator(type,(function(expression,state,options){throw new Error("Unknown function "+type)}),AEL.ReturnType.String)};return 0===matchCount?interpolatedString:1===matchCount&&lastMatch[0].length===interpolatedString.length?AEL.Expression.parse(lastMatch[1],lookup):AEL.Expression.parse("`"+interpolatedString+"`",lookup)},Template.tryEvaluateExpression=function(expression,context,allowSubstitutions){return Template.internalTryEvaluateExpression(expression,new EvaluationContext(context),allowSubstitutions)},Template.prototype.expandSingleObject=function(node){for(var result={},keys,_i=0,keys_2=Object.keys(node);_i<keys_2.length;_i++){var key=keys_2[_i];if(!this._context.isReservedField(key)){var value=this.internalExpand(node[key]);void 0!==value&&(result[key]=value)}}return result},Template.prototype.internalExpand=function(node){var result;if(this._context.saveState(),Array.isArray(node)){for(var itemArray=[],_i=0,node_2=node;_i<node_2.length;_i++){var item=node_2[_i],expandedItem=this.internalExpand(item);null!==expandedItem&&(Array.isArray(expandedItem)?itemArray=itemArray.concat(expandedItem):itemArray.push(expandedItem))}result=itemArray}else if(node instanceof AEL.Expression){var evaluationResult;if((evaluationResult=Template.internalTryEvaluateExpression(node,this._context,!0)).error)throw new Error(evaluationResult.error);result=evaluationResult.value}else if("object"==typeof node&&null!==node){var when=node.$when,dataContext=node.$data,dataContextIsArray=!1,dataContexts=void 0;if(void 0===dataContext)dataContexts=[void 0];else{if(dataContext instanceof AEL.Expression){var evaluationResult;if((evaluationResult=Template.internalTryEvaluateExpression(dataContext,this._context,!0)).error)throw new Error(evaluationResult.error);dataContext=evaluationResult.value}Array.isArray(dataContext)?(dataContexts=dataContext,dataContextIsArray=!0):dataContexts=[dataContext]}result=[];for(var i=0;i<dataContexts.length;i++){dataContextIsArray&&(this._context.$index=i),void 0!==dataContexts[i]&&(this._context.$data=dataContexts[i]);var dropObject=!1;if(when instanceof AEL.Expression){var evaluationResult,whenValue=!1;(evaluationResult=Template.internalTryEvaluateExpression(when,this._context,!1)).error||(whenValue="boolean"==typeof evaluationResult.value&&evaluationResult.value),dropObject=!whenValue}if(!dropObject){var expandedObject=this.expandSingleObject(node);null!==expandedObject&&result.push(expandedObject)}}0===result.length?result=null:1===result.length&&(result=result[0])}else result=node;return this._context.restoreLastState(),result},Template.prototype.expand=function(context){return this._context=new EvaluationContext(context),this.internalExpand(this._preparedPayload)},Template}();exports.Template=Template},"../adaptivecards-templating/node_modules/@microsoft/recognizers-text-data-types-timex-expression/dist/recognizers-text-data-types-timex-expression.browser.js":
/*!*********************************************************************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/@microsoft/recognizers-text-data-types-timex-expression/dist/recognizers-text-data-types-timex-expression.browser.js ***!
  \*********************************************************************************************************************************************************************/
/*! no static exports found */function(module,exports){var microsoftRecognizersTextDataTypesTimexExpression=function(exports){"use strict";class Time{constructor(hour,minute,second){1===arguments.length?(this.hour=Math.floor(hour/36e5),this.minute=Math.floor((hour-36e5*this.hour)/6e4),this.second=(hour-36e5*this.hour-6e4*this.minute)/1e3):(this.hour=hour,this.minute=minute,this.second=second)}getTime(){return 1e3*this.second+6e4*this.minute+36e5*this.hour}}var Time_1,time={Time:Time};const value=function(s){return s},isTrue=function(){return!0},zero=function(){return 0},timexRegex={date:[{regex:/^(\d\d\d\d)-(\d\d)-(\d\d)$/,props:{year:Number,month:Number,dayOfMonth:Number}},{regex:/^XXXX-WXX-(\d)$/,props:{dayOfWeek:Number}},{regex:/^XXXX-(\d\d)-(\d\d)$/,props:{month:Number,dayOfMonth:Number}},{regex:/^(\d\d\d\d)$/,props:{year:Number}},{regex:/^(\d\d\d\d)-(\d\d)$/,props:{year:Number,month:Number}},{regex:/^(SP|SU|FA|WI)$/,props:{season:value}},{regex:/^(\d\d\d\d)-(SP|SU|FA|WI)$/,props:{year:Number,season:value}},{regex:/^(\d\d\d\d)-W(\d\d)$/,props:{year:Number,weekOfYear:Number}},{regex:/^(\d\d\d\d)-W(\d\d)-WE$/,props:{year:Number,weekOfYear:Number,weekend:isTrue}},{regex:/^XXXX-(\d\d)$/,props:{month:Number}},{regex:/^XXXX-(\d\d)-W(\d\d)$/,props:{month:Number,weekOfMonth:Number}},{regex:/^XXXX-(\d\d)-WXX-(\d)-(\d)$/,props:{month:Number,weekOfMonth:Number,dayOfWeek:Number}}],time:[{regex:/^T(\d\d)$/,props:{hour:Number,minute:zero,second:zero}},{regex:/^T(\d\d):(\d\d)$/,props:{hour:Number,minute:Number,second:zero}},{regex:/^T(\d\d):(\d\d):(\d\d)$/,props:{hour:Number,minute:Number,second:Number}},{regex:/^T(DT|NI|MO|AF|EV)$/,props:{partOfDay:value}}],period:[{regex:/^P(\d*\.?\d+)(Y|M|W|D)$/,props:{amount:Number,dateUnit:value}},{regex:/^PT(\d*\.?\d+)(H|M|S)$/,props:{amount:Number,timeUnit:value}}]},tryExtract=function(entry,timex,result){const regexResult=timex.match(entry.regex);if(!regexResult)return!1;let index=1;for(const name in entry.props){const val=regexResult[index++];result[name]=entry.props[name](val)}return!0},extract=function(name,timex,result){for(const entry of timexRegex[name])if(tryExtract(entry,timex,result))return!0;return!1};var extract_1,timexregex={extract:extract};const parseString=function(timex,obj){"PRESENT_REF"===timex?obj.now=!0:timex.startsWith("P")?extractDuration(timex,obj):timex.startsWith("(")&&timex.endsWith(")")?extractStartEndRange(timex,obj):extractDateTime(timex,obj)},extractDuration=function(s,obj){const extracted={};timexregex.extract("period",s,extracted),extracted.dateUnit?obj[{Y:"years",M:"months",W:"weeks",D:"days"}[extracted.dateUnit]]=extracted.amount:extracted.timeUnit&&(obj[{H:"hours",M:"minutes",S:"seconds"}[extracted.timeUnit]]=extracted.amount)},extractStartEndRange=function(s,obj){const parts=s.substring(1,s.length-1).split(",");3===parts.length&&(extractDateTime(parts[0],obj),extractDuration(parts[2],obj))},extractDateTime=function(s,obj){const indexOfT=s.indexOf("T");-1===indexOfT?timexregex.extract("date",s,obj):(timexregex.extract("date",s.substr(0,indexOfT),obj),timexregex.extract("time",s.substr(indexOfT),obj))},fromObject=function(source,obj){Object.assign(obj,source),"hour"in obj&&("minute"in obj||(obj.minute=0),"second"in obj||(obj.second=0))};var timexParsing_parseString=parseString,timexParsing_fromObject=fromObject;const isPresent=function(obj){return!0===obj.now},isDuration=function(obj){return"years"in obj||"months"in obj||"weeks"in obj||"days"in obj||"hours"in obj||"minutes"in obj||"seconds"in obj},isTime=function(obj){return"hour"in obj&&"minute"in obj&&"second"in obj},isDate=function(obj){return"month"in obj&&"dayOfMonth"in obj||"dayOfWeek"in obj},isTimeRange=function(obj){return"partOfDay"in obj},isDateRange=function(obj){return"year"in obj&&!("dayOfMonth"in obj)||"year"in obj&&"month"in obj&&!("dayOfMonth"in obj)||"month"in obj&&!("dayOfMonth"in obj)||"season"in obj||"weekOfYear"in obj||"weekOfMonth"in obj},isDefinite=function(obj){return"year"in obj&&"month"in obj&&"dayOfMonth"in obj},infer=function(obj){const types=new Set;return isPresent(obj)&&types.add("present"),isDefinite(obj)&&types.add("definite"),isDate(obj)&&types.add("date"),isDateRange(obj)&&types.add("daterange"),isDuration(obj)&&types.add("duration"),isTime(obj)&&types.add("time"),isTimeRange(obj)&&types.add("timerange"),types.has("present")&&(types.add("date"),types.add("time")),types.has("time")&&types.has("duration")&&types.add("timerange"),types.has("date")&&types.has("time")&&types.add("datetime"),types.has("date")&&types.has("duration")&&types.add("daterange"),types.has("datetime")&&types.has("duration")&&types.add("datetimerange"),types.has("date")&&types.has("timerange")&&types.add("datetimerange"),types};var infer_1,timexInference={infer:infer};const cloneDate=function(date){const result=new Date;return result.setTime(date.getTime()),result},tomorrow=function(date){const result=cloneDate(date);return result.setDate(result.getDate()+1),result},yesterday=function(date){const result=cloneDate(date);return result.setDate(result.getDate()-1),result},datePartEquals=function(dateX,dateY){return dateX.getFullYear()===dateY.getFullYear()&&dateX.getMonth()===dateY.getMonth()&&dateX.getDate()===dateY.getDate()},isDateInWeek=function(date,startOfWeek){let d=cloneDate(startOfWeek);for(let i=0;i<7;i++){if(datePartEquals(date,d))return!0;d=tomorrow(d)}return!1},isThisWeek=function(date,referenceDate){const startOfThisWeek=cloneDate(referenceDate);return startOfThisWeek.setDate(startOfThisWeek.getDate()-startOfThisWeek.getDay()),isDateInWeek(date,startOfThisWeek)},isNextWeek=function(date,referenceDate){const startOfNextWeek=cloneDate(referenceDate);return startOfNextWeek.setDate(startOfNextWeek.getDate()+(7-startOfNextWeek.getDay())),isDateInWeek(date,startOfNextWeek)},isLastWeek=function(date,referenceDate){const startOfLastWeek=cloneDate(referenceDate);return startOfLastWeek.setDate(startOfLastWeek.getDate()-(7+startOfLastWeek.getDay())),isDateInWeek(date,startOfLastWeek)},weekOfYear=function(date){const ds=new Date(date.getFullYear(),0),de=new Date(date.getFullYear(),date.getMonth(),date.getDate());let weeks=1;for(;ds.getTime()<de.getTime();){const jsDayOfWeek=ds.getDay(),isoDayOfWeek=0==jsDayOfWeek?7:jsDayOfWeek;7===isoDayOfWeek&&weeks++,ds.setDate(ds.getDate()+1)}return weeks},fixedFormatNumber$1=function(n,size){const s=n.toString();let zeros="";const np=size-s.length;for(let i=0;i<np;i++)zeros+="0";return`${zeros}${s}`},dateOfLastDay=function(day,referenceDate){const result=cloneDate(referenceDate);for(result.setDate(result.getDate()-1);result.getDay()!==day;)result.setDate(result.getDate()-1);return result},dateOfNextDay=function(day,referenceDate){const result=cloneDate(referenceDate);do{result.setDate(result.getDate()+1)}while(result.getDay()!==day);return result},datesMatchingDay=function(day,start,end){const result=[],d=cloneDate(start);for(;!datePartEquals(d,end);)d.getDay()===day&&result.push(cloneDate(d)),d.setDate(d.getDate()+1);return result};var timexDateHelpers_tomorrow=tomorrow,timexDateHelpers_yesterday=yesterday,timexDateHelpers_datePartEquals=datePartEquals,timexDateHelpers_isThisWeek=isThisWeek,timexDateHelpers_isNextWeek=isNextWeek,timexDateHelpers_isLastWeek=isLastWeek,timexDateHelpers_weekOfYear=weekOfYear,timexDateHelpers_fixedFormatNumber,timexDateHelpers_dateOfLastDay=dateOfLastDay,timexDateHelpers_dateOfNextDay=dateOfNextDay,timexDateHelpers_datesMatchingDay=datesMatchingDay;const Time$1=time.Time,cloneDateTime=function(timex){const result=Object.assign({},timex);return delete result.years,delete result.months,delete result.weeks,delete result.days,delete result.hours,delete result.minutes,delete result.seconds,result},cloneDuration=function(timex){const result=Object.assign({},timex);return delete result.year,delete result.month,delete result.dayOfMonth,delete result.dayOfWeek,delete result.weekOfYear,delete result.weekOfMonth,delete result.season,delete result.hour,delete result.minute,delete result.second,delete result.weekend,delete result.partOfDay,result},timexDateAdd$1=function(start,duration){if("dayOfWeek"in start){const end=Object.assign({},start);return"days"in duration&&(end.dayOfWeek+=duration.days),end}if("month"in start&&"dayOfMonth"in start){if("days"in duration){if("year"in start){const d=new Date(start.year,start.month-1,start.dayOfMonth,0,0,0);for(let i=0;i<duration.days;i++)d.setDate(d.getDate()+1);return{year:d.getFullYear(),month:d.getMonth()+1,dayOfMonth:d.getDate()}}{const d=new Date(2001,start.month-1,start.dayOfMonth,0,0,0);for(let i=0;i<duration.days;i++)d.setDate(d.getDate()+1);return{month:d.getMonth()+1,dayOfMonth:d.getDate()}}}if("years"in duration&&"year"in start)return{year:start.year+duration.years,month:start.month,dayOfMonth:start.dayOfMonth};if("months"in duration&&"month"in start)return{year:start.year,month:start.month+duration.months,dayOfMonth:start.dayOfMonth}}return start},timexTimeAdd$1=function(start,duration){if("hours"in duration){const result=Object.assign({},start);if(result.hour+=duration.hours,result.hour>23){const days=Math.floor(result.hour/24),hour=result.hour%24;if(result.hour=hour,"year"in result&&"month"in result&&"dayOfMonth"in result){const d=new Date(result.year,result.month-1,result.dayOfMonth,0,0,0);for(let i=0;i<days;i++)d.setDate(d.getDate()+1);return result.year=d.getFullYear(),result.month=d.getMonth()+1,result.dayOfMonth=d.getDate(),result}if("dayOfWeek"in result)return result.dayOfWeek+=days,result}return result}if("minutes"in duration){const result=Object.assign({},start);return result.minute+=duration.minutes,result.minute>59&&(result.hour++,result.minute=0),result}return start},timexDateTimeAdd$1=function(start,duration){return timexTimeAdd$1(timexDateAdd$1(start,duration),duration)},expandDateTimeRange=function(timex){const types="types"in timex?timex.types:timexInference.infer(timex);if(types.has("duration")){const start=cloneDateTime(timex),duration=cloneDuration(timex);return{start:start,end:timexDateTimeAdd$1(start,duration),duration:duration}}if("year"in timex){const range={start:{year:timex.year},end:{}};return"month"in timex?(range.start.month=timex.month,range.start.dayOfMonth=1,range.end.year=timex.year,range.end.month=timex.month+1,range.end.dayOfMonth=1):(range.start.month=1,range.start.dayOfMonth=1,range.end.year=timex.year+1,range.end.month=1,range.end.dayOfMonth=1),range}return{start:{},end:{}}},timeAdd=function(start,duration){const hours=duration.hours||0,minutes=duration.minutes||0,seconds=duration.seconds||0;return{hour:start.hour+hours,minute:start.minute+minutes,second:start.second+seconds}},expandTimeRange=function(timex){if(!timex.types.has("timerange"))throw new exception("argument must be a timerange");if(void 0!==timex.partOfDay)switch(timex.partOfDay){case"DT":timex={hour:8,minute:0,second:0,hours:10,minutes:0,seconds:0};break;case"MO":timex={hour:8,minute:0,second:0,hours:4,minutes:0,seconds:0};break;case"AF":timex={hour:12,minute:0,second:0,hours:4,minutes:0,seconds:0};break;case"EV":timex={hour:16,minute:0,second:0,hours:4,minutes:0,seconds:0};break;case"NI":timex={hour:20,minute:0,second:0,hours:4,minutes:0,seconds:0};break;default:throw new exception("unrecognized part of day timerange")}const start={hour:timex.hour,minute:timex.minute,second:timex.second},duration=cloneDuration(timex);return{start:start,end:timeAdd(start,duration),duration:duration}},dateFromTimex=function(timex){const year="year"in timex?timex.year:2001,month="month"in timex?timex.month-1:0,date="dayOfMonth"in timex?timex.dayOfMonth:1,hour="hour"in timex?timex.hour:0,minute="minute"in timex?timex.minute:0,second="second"in timex?timex.second:0;return new Date(year,month,date,hour,minute,second)},timeFromTimex=function(timex){const hour=timex.hour||0,minute=timex.minute||0,second=timex.second||0;return new Time$1(hour,minute,second)},dateRangeFromTimex=function(timex){const expanded=expandDateTimeRange(timex);return{start:dateFromTimex(expanded.start),end:dateFromTimex(expanded.end)}},timeRangeFromTimex=function(timex){const expanded=expandTimeRange(timex);return{start:timeFromTimex(expanded.start),end:timeFromTimex(expanded.end)}};var timexHelpers_expandDateTimeRange=expandDateTimeRange,timexHelpers_expandTimeRange=expandTimeRange,timexHelpers_dateFromTimex=dateFromTimex,timexHelpers_timeFromTimex=timeFromTimex,timexHelpers_dateRangeFromTimex=dateRangeFromTimex,timexHelpers_timeRangeFromTimex=timeRangeFromTimex,timexHelpers_timexTimeAdd=timexTimeAdd$1,timexHelpers_timexDateTimeAdd=timexDateTimeAdd$1;const fixedFormatNumber=fixedFormatNumber$1,formatDuration=function(timex){return"years"in timex?`P${timex.years}Y`:"months"in timex?`P${timex.months}M`:"weeks"in timex?`P${timex.weeks}W`:"days"in timex?`P${timex.days}D`:"hours"in timex?`PT${timex.hours}H`:"minutes"in timex?`PT${timex.minutes}M`:"seconds"in timex?`PT${timex.seconds}S`:""},formatTime=function(timex){return 0===timex.minute&&0===timex.second?`T${fixedFormatNumber(timex.hour,2)}`:0===timex.second?`T${fixedFormatNumber(timex.hour,2)}:${fixedFormatNumber(timex.minute,2)}`:`T${fixedFormatNumber(timex.hour,2)}:${fixedFormatNumber(timex.minute,2)}:${fixedFormatNumber(timex.second,2)}`},formatDate=function(timex){return"year"in timex&&"month"in timex&&"dayOfMonth"in timex?`${fixedFormatNumber(timex.year,4)}-${fixedFormatNumber(timex.month,2)}-${fixedFormatNumber(timex.dayOfMonth,2)}`:"month"in timex&&"dayOfMonth"in timex?`XXXX-${fixedFormatNumber(timex.month,2)}-${fixedFormatNumber(timex.dayOfMonth,2)}`:"dayOfWeek"in timex?`XXXX-WXX-${timex.dayOfWeek}`:""},formatDateRange=function(timex){return"year"in timex&&"weekOfYear"in timex&&"weekend"in timex?`${fixedFormatNumber(timex.year,4)}-W${fixedFormatNumber(timex.weekOfYear,2)}-WE`:"year"in timex&&"weekOfYear"in timex?`${fixedFormatNumber(timex.year,4)}-W${fixedFormatNumber(timex.weekOfYear,2)}`:"year"in timex&&"season"in timex?`${fixedFormatNumber(timex.year,4)}-${timex.season}`:"season"in timex?`${timex.season}`:"year"in timex&&"month"in timex?`${fixedFormatNumber(timex.year,4)}-${fixedFormatNumber(timex.month,2)}`:"year"in timex?`${fixedFormatNumber(timex.year,4)}`:"month"in timex&&"weekOfMonth"in timex&&"dayOfWeek"in timex?`XXXX-${fixedFormatNumber(timex.month,2)}-WXX-${timex.weekOfMonth}-${timex.dayOfWeek}`:"month"in timex&&"weekOfMonth"in timex?`XXXX-${fixedFormatNumber(timex.month,2)}-WXX-${timex.weekOfMonth}`:"month"in timex?`XXXX-${fixedFormatNumber(timex.month,2)}`:""},formatTimeRange=function(timex){return"partOfDay"in timex?`T${timex.partOfDay}`:""},format=function(timex){const types="types"in timex?timex.types:timexInference.infer(timex);if(types.has("present"))return"PRESENT_REF";if((types.has("datetimerange")||types.has("daterange")||types.has("timerange"))&&types.has("duration")){const range=timexHelpers_expandDateTimeRange(timex);return`(${format(range.start)},${format(range.end)},${format(range.duration)})`}return types.has("datetimerange")?`${formatDate(timex)}${formatTimeRange(timex)}`:types.has("daterange")?`${formatDateRange(timex)}`:types.has("timerange")?`${formatTimeRange(timex)}`:types.has("datetime")?`${formatDate(timex)}${formatTime(timex)}`:types.has("duration")?`${formatDuration(timex)}`:types.has("date")?`${formatDate(timex)}`:types.has("time")?`${formatTime(timex)}`:""};var format_1,timexFormat={format:format},days,months,dateAbbreviation,hours,seasons,weeks,dayParts,timexConstants={days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","Februrary","March","April","May","June","July","August","September","October","November","December"],dateAbbreviation:{0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"},hours:["midnight","1AM","2AM","3AM","4AM","5AM","6AM","7AM","8AM","9AM","10AM","11AM","midday","1PM","2PM","3PM","4PM","5PM","6PM","7PM","8PM","9PM","10PM","11PM"],seasons:{SP:"spring",SU:"summer",FA:"fall",WI:"winter"},weeks:["first","second","third","forth"],dayParts:{DT:"daytime",NI:"night",MO:"morning",AF:"afternoon",EV:"evening"}};const convertDate=function(timex){if("dayOfWeek"in timex)return timexConstants.days[timex.dayOfWeek-1];const month=timexConstants.months[timex.month-1],date=timex.dayOfMonth.toString(),abbreviation=timexConstants.dateAbbreviation[date.slice(-1)];return"year"in timex?`${date}${abbreviation} ${month} ${timex.year}`.trim():`${date}${abbreviation} ${month}`},convertTime=function(timex){if(0===timex.hour&&0===timex.minute&&0===timex.second)return"midnight";if(12===timex.hour&&0===timex.minute&&0===timex.second)return"midday";const pad=function(s){return 1===s.length?"0"+s:s},hour=0===timex.hour?"12":timex.hour>12?(timex.hour-12).toString():timex.hour.toString(),minute=0===timex.minute&&0===timex.second?"":":"+pad(timex.minute.toString()),second=0===timex.second?"":":"+pad(timex.second.toString()),period=timex.hour<12?"AM":"PM";return`${hour}${minute}${second}${period}`},convertDurationPropertyToString=function(timex,property,includeSingleCount){const propertyName=property+"s",value=timex[propertyName];return void 0!==value&&(1===value?includeSingleCount?"1 "+property:property:`${value} ${property}s`)},convertTimexDurationToString=function(timex,includeSingleCount){return convertDurationPropertyToString(timex,"year",includeSingleCount)||convertDurationPropertyToString(timex,"month",includeSingleCount)||convertDurationPropertyToString(timex,"week",includeSingleCount)||convertDurationPropertyToString(timex,"day",includeSingleCount)||convertDurationPropertyToString(timex,"hour",includeSingleCount)||convertDurationPropertyToString(timex,"minute",includeSingleCount)||convertDurationPropertyToString(timex,"second",includeSingleCount)},convertDuration=function(timex){return convertTimexDurationToString(timex,!0)},convertDateRange=function(timex){const season="season"in timex?timexConstants.seasons[timex.season]:"",year="year"in timex?timex.year.toString():"";if("weekOfYear"in timex)return timex.weekend,"";if("month"in timex){const month=`${timexConstants.months[timex.month-1]}`;return"weekOfMonth"in timex?`${timexConstants.weeks[timex.weekOfMonth-1]} week of ${month}`:`${month} ${year}`.trim()}return`${season} ${year}`.trim()},convertTimeRange=function(timex){return timexConstants.dayParts[timex.partOfDay]},convertDateTime=function(timex){return`${convertTime(timex)} ${convertDate(timex)}`},convertDateTimeRange=function(timex){return timex.types.has("timerange")?`${convertDate(timex)} ${convertTimeRange(timex)}`:""},convertTimexToString=function(timex){const types="types"in timex?timex.types:timexInference.infer(timex);return types.has("present")?"now":types.has("datetimerange")?convertDateTimeRange(timex):types.has("daterange")?convertDateRange(timex):types.has("duration")?convertDuration(timex):types.has("timerange")?convertTimeRange(timex):types.has("datetime")?convertDateTime(timex):types.has("date")?convertDate(timex):types.has("time")?convertTime(timex):""},convertTimexSetToString=function(timexSet){const timex=timexSet.timex;return timex.types.has("duration")?`every ${convertTimexDurationToString(timex,!1)}`:`every ${convertTimexToString(timex)}`};var timexConvert$2={convertDate:convertDate,convertTime:convertTime,convertTimexToString:convertTimexToString,convertTimexSetToString:convertTimexSetToString},timexConvert={convertTimexToString:timexConvert$2.convertTimexToString,convertTimexSetToString:timexConvert$2.convertTimexSetToString};const getDateDay=function(day){const index=0===day?6:day-1;return timexConstants.days[index]},convertDate$1=function(timex,date){if("year"in timex&&"month"in timex&&"dayOfMonth"in timex){const timexDate=new Date(timex.year,timex.month-1,timex.dayOfMonth);if(timexDateHelpers_datePartEquals(timexDate,date))return"today";const tomorrow=timexDateHelpers_tomorrow(date);if(timexDateHelpers_datePartEquals(timexDate,tomorrow))return"tomorrow";const yesterday=timexDateHelpers_yesterday(date);if(timexDateHelpers_datePartEquals(timexDate,yesterday))return"yesterday";if(timexDateHelpers_isThisWeek(timexDate,date))return`this ${getDateDay(timexDate.getDay())}`;if(timexDateHelpers_isNextWeek(timexDate,date))return`next ${getDateDay(timexDate.getDay())}`;if(timexDateHelpers_isLastWeek(timexDate,date))return`last ${getDateDay(timexDate.getDay())}`}return timexConvert$2.convertDate(timex)},convertDateTime$1=function(timex,date){return`${convertDate$1(timex,date)} ${timexConvert$2.convertTime(timex)}`},convertDateRange$1=function(timex,date){if("year"in timex){const year=date.getFullYear();if(timex.year===year){if("weekOfYear"in timex){const thisWeek=timexDateHelpers_weekOfYear(date);if(thisWeek===timex.weekOfYear)return timex.weekend?"this weekend":"this week";if(thisWeek===timex.weekOfYear+1)return timex.weekend?"last weekend":"last week";if(thisWeek===timex.weekOfYear-1)return timex.weekend?"next weekend":"next week"}if("month"in timex){const isoMonth=date.getMonth()+1;if(timex.month===isoMonth)return"this month";if(timex.month===isoMonth+1)return"next month";if(timex.month===isoMonth-1)return"last month"}return"season"in timex?`this ${timexConstants.seasons[timex.season]}`:"this year"}if(timex.year===year+1)return"season"in timex?`next ${timexConstants.seasons[timex.season]}`:"next year";if(timex.year===year-1)return"season"in timex?`last ${timexConstants.seasons[timex.season]}`:"last year"}return""},convertDateTimeRange$1=function(timex,date){if("year"in timex&&"month"in timex&&"dayOfMonth"in timex){const timexDate=new Date(timex.year,timex.month-1,timex.dayOfMonth);if("partOfDay"in timex){if(timexDateHelpers_datePartEquals(timexDate,date))return"NI"===timex.partOfDay?"tonight":`this ${timexConstants.dayParts[timex.partOfDay]}`;const tomorrow=timexDateHelpers_tomorrow(date);if(timexDateHelpers_datePartEquals(timexDate,tomorrow))return`tomorrow ${timexConstants.dayParts[timex.partOfDay]}`;const yesterday=timexDateHelpers_yesterday(date);if(timexDateHelpers_datePartEquals(timexDate,yesterday))return`yesterday ${timexConstants.dayParts[timex.partOfDay]}`;if(timexDateHelpers_isNextWeek(timexDate,date))return`next ${getDateDay(timexDate.getDay())} ${timexConstants.dayParts[timex.partOfDay]}`;if(timexDateHelpers_isLastWeek(timexDate,date))return`last ${getDateDay(timexDate.getDay())} ${timexConstants.dayParts[timex.partOfDay]}`}}return""},convertTimexToStringRelative$1=function(timex,date){const types="types"in timex?timex.types:timexInference.infer(timex);return types.has("datetimerange")?convertDateTimeRange$1(timex,date):types.has("daterange")?convertDateRange$1(timex,date):types.has("datetime")?convertDateTime$1(timex,date):types.has("date")?convertDate$1(timex,date):timexConvert$2.convertTimexToString(timex)};var convertTimexToStringRelative_1,timexRelativeConvert$2,convertTimexToStringRelative,timexRelativeConvert={convertTimexToStringRelative:{convertTimexToStringRelative:convertTimexToStringRelative$1}.convertTimexToStringRelative};class TimexProperty{constructor(timex){"string"==typeof timex?timexParsing_parseString(timex,this):timexParsing_fromObject(timex,this)}get timex(){return timexFormat.format(this)}get types(){return timexInference.infer(this)}toString(){return timexConvert.convertTimexToString(this)}toNaturalLanguage(referenceDate){return timexRelativeConvert.convertTimexToStringRelative(this,referenceDate)}static fromDate(date){return new TimexProperty({year:date.getFullYear(),month:date.getMonth()+1,dayOfMonth:date.getDate()})}static fromDateTime(date){return new TimexProperty({year:date.getFullYear(),month:date.getMonth()+1,dayOfMonth:date.getDate(),hour:date.getHours(),minute:date.getMinutes(),second:date.getSeconds()})}static fromTime(time){return new TimexProperty(time)}}var TimexProperty_1,timexProperty={TimexProperty:TimexProperty};const TimexProperty$1=timexProperty.TimexProperty;class TimexSet{constructor(timex){this.timex=new TimexProperty$1(timex)}}var TimexSet_1,timexSet;const TimexProperty$2=timexProperty.TimexProperty,today=function(date){return TimexProperty$2.fromDate(date||new Date).timex},tomorrow$1=function(date){const d=void 0===date?new Date:new Date(date.getTime());return d.setDate(d.getDate()+1),TimexProperty$2.fromDate(d).timex},yesterday$1=function(date){const d=void 0===date?new Date:new Date(date.getTime());return d.setDate(d.getDate()-1),TimexProperty$2.fromDate(d).timex},weekFromToday=function(date){const d=void 0===date?new Date:new Date(date.getTime());return new TimexProperty$2(Object.assign(TimexProperty$2.fromDate(d),{days:7})).timex},weekBackFromToday=function(date){const d=void 0===date?new Date:new Date(date.getTime());return d.setDate(d.getDate()-7),new TimexProperty$2(Object.assign(TimexProperty$2.fromDate(d),{days:7})).timex},thisWeek=function(date){const d=void 0===date?new Date:new Date(date.getTime());d.setDate(d.getDate()-7);const start=timexDateHelpers_dateOfNextDay(1,d);return new TimexProperty$2(Object.assign(TimexProperty$2.fromDate(start),{days:7})).timex},nextWeek=function(date){const d=void 0===date?new Date:new Date(date.getTime()),start=timexDateHelpers_dateOfNextDay(1,d);return new TimexProperty$2(Object.assign(TimexProperty$2.fromDate(start),{days:7})).timex},lastWeek=function(date){const d=void 0===date?new Date:new Date(date.getTime()),start=timexDateHelpers_dateOfLastDay(1,d);return start.setDate(start.getDate()-7),new TimexProperty$2(Object.assign(TimexProperty$2.fromDate(start),{days:7})).timex},nextWeeksFromToday=function(n,date){const d=void 0===date?new Date:new Date(date.getTime());return new TimexProperty$2(Object.assign(TimexProperty$2.fromDate(d),{days:7*n})).timex},monday="XXXX-WXX-1",tuesday="XXXX-WXX-2",wednesday="XXXX-WXX-3",thursday="XXXX-WXX-4",friday="XXXX-WXX-5",saturday="XXXX-WXX-6",sunday="XXXX-WXX-7",morning="(T08,T12,PT4H)",afternoon="(T12,T16,PT4H)",evening="(T16,T20,PT4H)",daytime="(T08,T18,PT10H)";var timexCreator;const isOverlapping=function(r1,r2){return r1.end.getTime()>r2.start.getTime()&&r1.start.getTime()<=r2.start.getTime()||r1.start.getTime()<r2.end.getTime()&&r1.start.getTime()>=r2.start.getTime()},collapseOverlapping=function(r1,r2,T){return{start:new T(Math.max(r1.start.getTime(),r2.start.getTime())),end:new T(Math.min(r1.end.getTime(),r2.end.getTime()))}},innerCollapse=function(ranges,T){if(1===ranges.length)return!1;for(let i=0;i<ranges.length;i++){const r1=ranges[i];for(let j=i+1;j<ranges.length;j++){const r2=ranges[j];if(isOverlapping(r1,r2))return ranges.splice(i,1),ranges.splice(j-1,1),ranges.push(collapseOverlapping(r1,r2,T)),!0}}return!1},collapse=function(ranges,T){const r=ranges.slice(0);for(;innerCollapse(r,T););return r.sort((a,b)=>a.start.getTime()-b.start.getTime()),r};var timexConstraintsHelper_collapse=collapse,timexConstraintsHelper_isOverlapping=isOverlapping;const Time$2=time.Time,TimexProperty$3=timexProperty.TimexProperty,resolveDefiniteAgainstConstraint=function(timex,constraint){const timexDate=timexHelpers_dateFromTimex(timex);return timexDate.getTime()>=constraint.start.getTime()&&timexDate.getTime()<constraint.end.getTime()?[timex.timex]:[]},resolveDateAgainstConstraint=function(timex,constraint){if("month"in timex&&"dayOfMonth"in timex){const result=[];for(let year=constraint.start.getFullYear();year<=constraint.end.getFullYear();year++){const r=resolveDefiniteAgainstConstraint(new TimexProperty$3(Object.assign({},timex,{year:year})),constraint);r.length>0&&result.push(r[0])}return result}if("dayOfWeek"in timex){const day=7===timex.dayOfWeek?0:timex.dayOfWeek,dates=timexDateHelpers_datesMatchingDay(day,constraint.start,constraint.end),result=[];for(const d of dates){const t=Object.assign({},timex);delete t.dayOfWeek;const r=new TimexProperty$3(Object.assign({},t,{year:d.getFullYear(),month:d.getMonth()+1,dayOfMonth:d.getDate()}));result.push(r.timex)}return result}return[]},resolveDate=function(timex,constraints){const result=[];for(const constraint of constraints)Array.prototype.push.apply(result,resolveDateAgainstConstraint(timex,constraint));return result},resolveTimeAgainstConstraint=function(timex,constraint){const t=new Time$2(timex.hour,timex.minute,timex.second);return t.getTime()>=constraint.start.getTime()&&t.getTime()<constraint.end.getTime()?[timex.timex]:[]},resolveTime=function(timex,constraints){const result=[];for(const constraint of constraints)Array.prototype.push.apply(result,resolveTimeAgainstConstraint(timex,constraint));return result},removeDuplicates=function(array){var seen=new Set;return array.filter(item=>!seen.has(item)&&seen.add(item))},resolveByDateRangeConstraints=function(candidates,timexConstraints){const dateRangeConstraints=timexConstraints.filter(timex=>timex.types.has("daterange")).map(timex=>timexHelpers_dateRangeFromTimex(timex)),collapsedDateRanges=timexConstraintsHelper_collapse(dateRangeConstraints,Date);if(0===collapsedDateRanges.length)return candidates;const resolution=[];for(const timex of candidates){const r=resolveDate(new TimexProperty$3(timex),collapsedDateRanges);Array.prototype.push.apply(resolution,r)}return removeDuplicates(resolution)},resolveByTimeConstraints=function(candidates,timexConstraints){const times=timexConstraints.filter(timex=>timex.types.has("time")).map(timex=>timexHelpers_timeFromTimex(timex));if(0===times.length)return candidates;const resolution=[];for(const timex of candidates.map(t=>new TimexProperty$3(t)))if(timex.types.has("date")&&!timex.types.has("time"))for(const time$$2 of times)timex.hour=time$$2.hour,timex.minute=time$$2.minute,timex.second=time$$2.second,resolution.push(timex.timex);else resolution.push(timex.timex);return removeDuplicates(resolution)},resolveByTimeRangeConstraints=function(candidates,timexConstraints){const timeRangeConstraints=timexConstraints.filter(timex=>timex.types.has("timerange")).map(timex=>timexHelpers_timeRangeFromTimex(timex)),collapsedTimeRanges=timexConstraintsHelper_collapse(timeRangeConstraints,Time$2);if(0===collapsedTimeRanges.length)return candidates;const resolution=[];for(const timex of candidates){const t=new TimexProperty$3(timex);if(t.types.has("timerange")){const r=resolveTimeRange(t,collapsedTimeRanges);Array.prototype.push.apply(resolution,r)}else if(t.types.has("time")){const r=resolveTime(t,collapsedTimeRanges);Array.prototype.push.apply(resolution,r)}}return removeDuplicates(resolution)},resolveTimeRange=function(timex,constraints){const candidate=timexHelpers_timeRangeFromTimex(timex),result=[];for(const constraint of constraints)if(timexConstraintsHelper_isOverlapping(candidate,constraint)){const start=Math.max(candidate.start.getTime(),constraint.start.getTime()),time$$2=new Time$2(start),resolved=new TimexProperty$3(timex.timex);delete resolved.partOfDay,delete resolved.seconds,delete resolved.minutes,delete resolved.hours,resolved.second=time$$2.second,resolved.minute=time$$2.minute,resolved.hour=time$$2.hour,result.push(resolved.timex)}return result},resolveDuration=function(candidate,constraints){const results=[];for(const constraint of constraints)constraint.types.has("datetime")?results.push(new TimexProperty$3(timexHelpers_timexDateTimeAdd(constraint,candidate))):constraint.types.has("time")&&results.push(new TimexProperty$3(timexHelpers_timexTimeAdd(constraint,candidate)));return results},resolveDurations=function(candidates,constraints){const results=[];for(const candidate of candidates){const timex=new TimexProperty$3(candidate);if(timex.types.has("duration")){const r=resolveDuration(timex,constraints);for(const resolved of r)results.push(resolved.timex)}else results.push(candidate)}return results},evaluate=function(candidates,constraints){const timexConstraints=constraints.map(x=>new TimexProperty$3(x)),candidatesWithDurationsResolved=resolveDurations(candidates,timexConstraints),candidatesAccordingToDate=resolveByDateRangeConstraints(candidatesWithDurationsResolved,timexConstraints),candidatesWithAddedTime=resolveByTimeConstraints(candidatesAccordingToDate,timexConstraints),candidatesFilteredByTime=resolveByTimeRangeConstraints(candidatesWithAddedTime,timexConstraints),timexResults=candidatesFilteredByTime.map(x=>new TimexProperty$3(x));return timexResults};var timexRangeResolver,datatypesDateTime={Time:time.Time,TimexProperty:timexProperty.TimexProperty,TimexSet:{TimexSet:TimexSet}.TimexSet,creator:{today:today,tomorrow:tomorrow$1,yesterday:yesterday$1,weekFromToday:weekFromToday,weekBackFromToday:weekBackFromToday,thisWeek:thisWeek,nextWeek:nextWeek,lastWeek:lastWeek,nextWeeksFromToday:nextWeeksFromToday,monday:monday,tuesday:tuesday,wednesday:wednesday,thursday:thursday,friday:friday,saturday:saturday,sunday:sunday,morning:morning,afternoon:afternoon,evening:evening,daytime:daytime},resolver:{evaluate:evaluate}},datatypesDateTime_1=datatypesDateTime.Time,datatypesDateTime_2=datatypesDateTime.TimexProperty,datatypesDateTime_3=datatypesDateTime.TimexSet,datatypesDateTime_4=datatypesDateTime.creator,datatypesDateTime_5=datatypesDateTime.resolver;return exports.default=datatypesDateTime,exports.Time=datatypesDateTime_1,exports.TimexProperty=datatypesDateTime_2,exports.TimexSet=datatypesDateTime_3,exports.creator=datatypesDateTime_4,exports.resolver=datatypesDateTime_5,exports}({})},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/commonRegex.js":
/*!****************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/commonRegex.js ***!
  \****************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const antlr4ts_1=__webpack_require__(/*! antlr4ts */"../adaptivecards-templating/node_modules/antlr4ts/index.js"),lru_cache_1=__importDefault(__webpack_require__(/*! lru-cache */"../adaptivecards-templating/node_modules/lru-cache/index.js")),generated_1=__webpack_require__(/*! ./generated */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/generated/index.js"),regexErrorListener_1=__webpack_require__(/*! ./regexErrorListener */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/regexErrorListener.js");class CommonRegex{static CreateRegex(pattern){let result;if(pattern&&this.regexCache.has(pattern))result=this.regexCache.get(pattern);else{if(!pattern||!this.isCommonRegex(pattern))throw new Error(`'${pattern}' is not a valid regex.`);result=this.getRegExpFromString(pattern),this.regexCache.set(pattern,result)}return result}static getRegExpFromString(pattern){const flags=["(?i)","(?m)","(?s)"];let flag="",regexp;return flags.forEach(e=>{pattern.includes(e)&&(flag+=e.substr(2,1),pattern=pattern.replace(e,""))}),regexp=flag?new RegExp(`${pattern}`,flag):new RegExp(`${pattern}`),regexp}static isCommonRegex(pattern){try{this.antlrParse(pattern)}catch(Exception){return!1}return!0}static antlrParse(pattern){const inputStream=new antlr4ts_1.ANTLRInputStream(pattern),lexer=new generated_1.CommonRegexLexer(inputStream);lexer.removeErrorListeners();const tokenStream=new antlr4ts_1.CommonTokenStream(lexer),parser=new generated_1.CommonRegexParser(tokenStream);return parser.removeErrorListeners(),parser.addErrorListener(regexErrorListener_1.RegexErrorListener.Instance),parser.buildParseTree=!0,parser.parse()}}CommonRegex.regexCache=new lru_cache_1.default(15),exports.CommonRegex=CommonRegex},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/constant.js":
/*!*************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/constant.js ***!
  \*************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expression_1=__webpack_require__(/*! ./expression */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expression.js"),expressionEvaluator_1=__webpack_require__(/*! ./expressionEvaluator */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionEvaluator.js"),expressionType_1=__webpack_require__(/*! ./expressionType */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionType.js");class Constant extends expression_1.Expression{constructor(value){super(expressionType_1.ExpressionType.Constant,new expressionEvaluator_1.ExpressionEvaluator(expressionType_1.ExpressionType.Constant,expression=>({value:expression.value,error:void 0}))),this.singleQuotRegex=new RegExp(/'(?!\\)/g),this.value=value}get value(){return this._value}set value(theValue){this.evaluator.returnType="string"==typeof theValue?expression_1.ReturnType.String:"boolean"==typeof theValue?expression_1.ReturnType.Boolean:"number"!=typeof theValue||Number.isNaN(theValue)?Array.isArray(theValue)?expression_1.ReturnType.Array:expression_1.ReturnType.Object:expression_1.ReturnType.Number,this._value=theValue}deepEquals(other){let eq;if(other&&other.type===this.type){let otherVal=other.value;eq=this.value===otherVal}else eq=!1;return eq}toString(){if(void 0===this.value)return"null";if("string"==typeof this.value){let result=this.value;return result=result.replace(/\\/g,"\\\\"),result=this.reverseString(this.reverseString(result).replace(this.singleQuotRegex,()=>"'\\")),`'${result}'`}return"number"==typeof this.value?this.value.toString():"object"==typeof this.value?JSON.stringify(this.value):this.value.toString()}reverseString(str){return str?str.split("").reverse().join(""):str}}exports.Constant=Constant},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/arrayExpressionConverter.js":
/*!****************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/arrayExpressionConverter.js ***!
  \****************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class ArrayExpressionConverter{convert(value){return new expressionProperties_1.ArrayExpression(value)}}exports.ArrayExpressionConverter=ArrayExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/boolExpressionConverter.js":
/*!***************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/boolExpressionConverter.js ***!
  \***************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class BoolExpressionConverter{convert(value){return new expressionProperties_1.BoolExpression(value)}}exports.BoolExpressionConverter=BoolExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/enumExpressionConverter.js":
/*!***************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/enumExpressionConverter.js ***!
  \***************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class EnumExpressionConverter{constructor(enumValue){this._enumValue=enumValue}convert(value){return"string"==typeof value?this._enumValue.hasOwnProperty(value)?new expressionProperties_1.EnumExpression(this._enumValue[value]):new expressionProperties_1.EnumExpression(`=${value}`):new expressionProperties_1.EnumExpression(value)}}exports.EnumExpressionConverter=EnumExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/expressionConverter.js":
/*!***********************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/expressionConverter.js ***!
  \***********************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expression_1=__webpack_require__(/*! ../expression */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expression.js");class ExpressionConverter{convert(value){return expression_1.Expression.parse(value)}}exports.ExpressionConverter=ExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/index.js":
/*!*********************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/index.js ***!
  \*********************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(/*! ./arrayExpressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/arrayExpressionConverter.js")),__export(__webpack_require__(/*! ./boolExpressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/boolExpressionConverter.js")),__export(__webpack_require__(/*! ./enumExpressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/enumExpressionConverter.js")),__export(__webpack_require__(/*! ./expressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/expressionConverter.js")),__export(__webpack_require__(/*! ./intExpressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/intExpressionConverter.js")),__export(__webpack_require__(/*! ./numberExpressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/numberExpressionConverter.js")),__export(__webpack_require__(/*! ./objectExpressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/objectExpressionConverter.js")),__export(__webpack_require__(/*! ./stringExpressionConveter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/stringExpressionConveter.js")),__export(__webpack_require__(/*! ./valueExpressionConverter */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/valueExpressionConverter.js"))},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/intExpressionConverter.js":
/*!**************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/intExpressionConverter.js ***!
  \**************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class IntExpressionConverter{convert(value){return new expressionProperties_1.IntExpression(value)}}exports.IntExpressionConverter=IntExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/numberExpressionConverter.js":
/*!*****************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/numberExpressionConverter.js ***!
  \*****************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class NumberExpressionConverter{convert(value){return new expressionProperties_1.NumberExpression(value)}}exports.NumberExpressionConverter=NumberExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/objectExpressionConverter.js":
/*!*****************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/objectExpressionConverter.js ***!
  \*****************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class ObjectExpressionConverter{convert(value){return new expressionProperties_1.ObjectExpression(value)}}exports.ObjectExpressionConverter=ObjectExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/stringExpressionConveter.js":
/*!****************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/stringExpressionConveter.js ***!
  \****************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class StringExpressionConverter{convert(value){return new expressionProperties_1.StringExpression(value)}}exports.StringExpressionConverter=StringExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/valueExpressionConverter.js":
/*!****************************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/converters/valueExpressionConverter.js ***!
  \****************************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expressionProperties_1=__webpack_require__(/*! ../expressionProperties */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionProperties/index.js");class ValueExpressionConverter{convert(value){return new expressionProperties_1.ValueExpression(value)}}exports.ValueExpressionConverter=ValueExpressionConverter},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/datetimeFormatConverter.js":
/*!****************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/datetimeFormatConverter.js ***!
  \****************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";var State;function convertCSharpDateTimeToMomentJS(fmtString){let fmtResult="",fmtState=State.None,lTokenBuffer="";if(0===fmtString.length)return fmtResult;if(1===fmtString.length)switch(fmtString){case"R":case"r":throw Error("RFC 1123 not supported  in MomentJS");case"O":case"o":fmtString="YYYY-MM-DDTHH:mm:ss.SSSSSSSZ";break;case"U":throw new Error("Universal Fulll Format not supported in MomentJS");case"u":throw new Error("Universal Sortable Format not supported in MomentJS")}const changeState=newState=>{switch(fmtState){case State.LowerD1:fmtResult+="D";break;case State.LowerD2:fmtResult+="DD";break;case State.LowerD3:fmtResult+="ddd";break;case State.LowerD4:fmtResult+="dddd";break;case State.LowerF1:case State.CapitalF1:fmtResult+="S";break;case State.LowerF2:case State.CapitalF2:fmtResult+="SS";break;case State.LowerF3:case State.CapitalF3:fmtResult+="SSS";break;case State.LowerF4:case State.CapitalF4:fmtResult+="SSSS";break;case State.LowerF5:case State.CapitalF5:fmtResult+="SSSSS";break;case State.LowerF6:case State.CapitalF6:fmtResult+="SSSSSS";break;case State.LowerF7:case State.CapitalF7:fmtResult+="SSSSSSS";break;case State.LowerG:throw Error("Era not supported in MomentJS");case State.LowerH1:fmtResult+="h";break;case State.LowerH2:fmtResult+="hh";break;case State.CapitalH1:fmtResult+="H";break;case State.CapitalH2:fmtResult+="HH";break;case State.LowerM1:fmtResult+="m";break;case State.LowerM2:fmtResult+="mm";break;case State.CapitalM1:fmtResult+="M";break;case State.CapitalM2:fmtResult+="MM";break;case State.CapitalM3:fmtResult+="MMM";break;case State.CapitalM4:fmtResult+="MMMM";break;case State.LowerS1:fmtResult+="s";break;case State.LowerS2:fmtResult+="ss";break;case State.LowerT1:case State.LowerT2:fmtResult+="A";break;case State.LowerY1:case State.LowerY2:fmtResult+="YY";break;case State.LowerY3:case State.LowerY4:fmtResult+="YYYY";break;case State.LowerY5:fmtResult+="Y";break;case State.LowerZ1:case State.LowerZ2:fmtResult+="ZZ";break;case State.LowerZ3:fmtResult+="Z";break;case State.InSingleQuoteLiteral:case State.InDoubleQuoteLiteral:case State.EscapeSequence:for(const lCharacter of lTokenBuffer)fmtResult+=lCharacter}lTokenBuffer="",fmtState=newState};for(const character of fmtString)if(fmtState===State.EscapeSequence)lTokenBuffer+=character,changeState(State.None);else if(fmtState===State.InDoubleQuoteLiteral)"`"==character?changeState(State.None):lTokenBuffer+=character;else if(fmtState==State.InSingleQuoteLiteral)"'"==character?changeState(State.None):lTokenBuffer+=character;else switch(character){case"d":switch(fmtState){case State.LowerD1:fmtState=State.LowerD2;break;case State.LowerD2:fmtState=State.LowerD3;break;case State.LowerD3:fmtState=State.LowerD4;break;case State.LowerD4:break;default:changeState(State.LowerD1)}break;case"f":switch(fmtState){case State.LowerF1:fmtState=State.LowerF2;break;case State.LowerF2:fmtState=State.LowerF3;break;case State.LowerF3:fmtState=State.LowerF4;break;case State.LowerF4:fmtState=State.LowerF5;break;case State.LowerF5:fmtState=State.LowerF6;break;case State.LowerF6:fmtState=State.LowerF7;break;case State.LowerF7:break;default:changeState(State.LowerF1)}break;case"F":switch(fmtState){case State.CapitalF1:fmtState=State.CapitalF2;break;case State.CapitalF2:fmtState=State.CapitalF3;break;case State.CapitalF3:fmtState=State.CapitalF4;break;case State.CapitalF4:fmtState=State.CapitalF5;break;case State.CapitalF5:fmtState=State.CapitalF6;break;case State.CapitalF6:fmtState=State.CapitalF7;break;case State.CapitalF7:break;default:changeState(State.CapitalF1)}break;case"g":switch(fmtState){case State.LowerG:break;default:changeState(State.LowerG)}break;case"h":switch(fmtState){case State.LowerH1:fmtState=State.LowerH2;break;case State.LowerH2:break;default:changeState(State.LowerH1)}break;case"H":switch(fmtState){case State.CapitalH1:fmtState=State.CapitalH2;break;case State.CapitalH2:break;default:changeState(State.CapitalH1)}break;case"K":changeState(State.None),fmtResult+="Z";break;case"m":switch(fmtState){case State.LowerM1:fmtState=State.LowerM2;break;case State.LowerM2:break;default:changeState(State.LowerM1)}break;case"M":switch(fmtState){case State.CapitalM1:fmtState=State.CapitalM2;break;case State.CapitalM2:fmtState=State.CapitalM3;break;case State.CapitalM3:fmtState=State.CapitalM4;break;case State.CapitalM4:break;default:changeState(State.CapitalM1)}break;case"s":switch(fmtState){case State.LowerS1:fmtState=State.LowerS2;break;case State.LowerS2:break;default:changeState(State.LowerS1)}break;case"t":switch(fmtState){case State.LowerT1:fmtState=State.LowerT2;break;case State.LowerT2:break;default:changeState(State.LowerT1)}break;case"y":switch(fmtState){case State.LowerY1:fmtState=State.LowerY2;break;case State.LowerY2:fmtState=State.LowerY3;break;case State.LowerY3:fmtState=State.LowerY4;break;case State.LowerY4:fmtState=State.LowerY5;break;case State.LowerY5:break;default:changeState(State.LowerY1)}break;case"z":switch(fmtState){case State.LowerZ1:fmtState=State.LowerZ2;break;case State.LowerZ2:fmtState=State.LowerZ3;break;case State.LowerZ3:break;default:changeState(State.LowerZ1)}break;case":":case"/":changeState(State.None),fmtResult+=":";break;case"`":changeState(State.InDoubleQuoteLiteral);break;case"'":changeState(State.InSingleQuoteLiteral);break;case"%":changeState(State.None);break;case"\\":changeState(State.EscapeSequence);break;default:changeState(State.None),fmtResult+=character}if(fmtState==State.EscapeSequence||fmtState==State.InDoubleQuoteLiteral||fmtState==State.InSingleQuoteLiteral)throw Error("Invalid Format String");return changeState(State.None),fmtResult}Object.defineProperty(exports,"__esModule",{value:!0}),function(State){State[State.None=0]="None",State[State.LowerD1=1]="LowerD1",State[State.LowerD2=2]="LowerD2",State[State.LowerD3=3]="LowerD3",State[State.LowerD4=4]="LowerD4",State[State.LowerF1=5]="LowerF1",State[State.LowerF2=6]="LowerF2",State[State.LowerF3=7]="LowerF3",State[State.LowerF4=8]="LowerF4",State[State.LowerF5=9]="LowerF5",State[State.LowerF6=10]="LowerF6",State[State.LowerF7=11]="LowerF7",State[State.CapitalF1=12]="CapitalF1",State[State.CapitalF2=13]="CapitalF2",State[State.CapitalF3=14]="CapitalF3",State[State.CapitalF4=15]="CapitalF4",State[State.CapitalF5=16]="CapitalF5",State[State.CapitalF6=17]="CapitalF6",State[State.CapitalF7=18]="CapitalF7",State[State.LowerG=19]="LowerG",State[State.LowerH1=20]="LowerH1",State[State.LowerH2=21]="LowerH2",State[State.CapitalH1=22]="CapitalH1",State[State.CapitalH2=23]="CapitalH2",State[State.CapitalK=24]="CapitalK",State[State.LowerM1=25]="LowerM1",State[State.LowerM2=26]="LowerM2",State[State.CapitalM1=27]="CapitalM1",State[State.CapitalM2=28]="CapitalM2",State[State.CapitalM3=29]="CapitalM3",State[State.CapitalM4=30]="CapitalM4",State[State.LowerS1=31]="LowerS1",State[State.LowerS2=32]="LowerS2",State[State.LowerT1=33]="LowerT1",State[State.LowerT2=34]="LowerT2",State[State.LowerY1=35]="LowerY1",State[State.LowerY2=36]="LowerY2",State[State.LowerY3=37]="LowerY3",State[State.LowerY4=38]="LowerY4",State[State.LowerY5=39]="LowerY5",State[State.LowerZ1=40]="LowerZ1",State[State.LowerZ2=41]="LowerZ2",State[State.LowerZ3=42]="LowerZ3",State[State.InSingleQuoteLiteral=43]="InSingleQuoteLiteral",State[State.InDoubleQuoteLiteral=44]="InDoubleQuoteLiteral",State[State.EscapeSequence=45]="EscapeSequence"}(State||(State={})),exports.convertCSharpDateTimeToMomentJS=convertCSharpDateTimeToMomentJS},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expression.js":
/*!***************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/expression.js ***!
  \***************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const functionTable_1=__webpack_require__(/*! ./functionTable */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/functionTable.js"),constant_1=__webpack_require__(/*! ./constant */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/constant.js"),expressionEvaluator_1=__webpack_require__(/*! ./expressionEvaluator */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionEvaluator.js"),expressionType_1=__webpack_require__(/*! ./expressionType */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionType.js"),memory_1=__webpack_require__(/*! ./memory */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/memory/index.js"),extensions_1=__webpack_require__(/*! ./extensions */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/extensions.js"),parser_1=__webpack_require__(/*! ./parser */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/parser/index.js"),options_1=__webpack_require__(/*! ./options */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/options.js");var ReturnType;!function(ReturnType){ReturnType[ReturnType.Boolean=1]="Boolean",ReturnType[ReturnType.Number=2]="Number",ReturnType[ReturnType.Object=4]="Object",ReturnType[ReturnType.String=8]="String",ReturnType[ReturnType.Array=16]="Array"}(ReturnType=exports.ReturnType||(exports.ReturnType={}));class Expression{constructor(type,evaluator,...children){if(this.validate=()=>this.evaluator.validateExpression(this),evaluator)this.evaluator=evaluator,this.children=children;else if(void 0!==type){if(!Expression.functions.get(type))throw Error(`${type} does not have an evaluator, it's not a built-in function or a custom function.`);this.evaluator=Expression.functions.get(type),this.children=children}}get returnType(){return this.evaluator.returnType}get type(){return this.evaluator.type}deepEquals(other){let eq=!1;if(!other&&(eq=this.type===other.type,eq))if(eq=this.children.length===other.children.length,this.type===expressionType_1.ExpressionType.And||this.type===expressionType_1.ExpressionType.Or)for(let i=0;eq&&i<this.children.length;i++){const primary=this.children[0];let found=!1;for(var j=0;j<this.children.length;j++)if(primary.deepEquals(other.children[j])){found=!0;break}eq=found}else for(let i=0;eq&&i<this.children.length;i++)eq=this.children[i].deepEquals(other.children[i]);return eq}references(){const{path:path,refs:refs}=this.referenceWalk(this);return void 0!==path&&refs.add(path),Array.from(refs)}referenceWalk(expression,extension){let path,refs=new Set;if(void 0===extension||!extension(expression)){const children=expression.children;if(expression.type===expressionType_1.ExpressionType.Accessor){const prop=children[0].value;1===children.length&&(path=prop),2===children.length&&(({path:path,refs:refs}=this.referenceWalk(children[1],extension)),void 0!==path&&(path=path.concat(".",prop)))}else if(expression.type===expressionType_1.ExpressionType.Element){if(({path:path,refs:refs}=this.referenceWalk(children[0],extension)),void 0!==path)if(children[1]instanceof constant_1.Constant){const cnst=children[1];cnst.returnType===ReturnType.String?path+=`.${cnst.value}`:path+=`[${cnst.value}]`}else refs.add(path);const result=this.referenceWalk(children[1],extension),idxPath=result.path,refs1=result.refs;refs=new Set([...refs,...refs1]),void 0!==idxPath&&refs.add(idxPath)}else if(expression.type===expressionType_1.ExpressionType.Foreach||expression.type===expressionType_1.ExpressionType.Where||expression.type===expressionType_1.ExpressionType.Select){let result=this.referenceWalk(children[0],extension);const child0Path=result.path,refs0=result.refs;void 0!==child0Path&&refs0.add(child0Path),result=this.referenceWalk(children[2],extension);const child2Path=result.path,refs2=result.refs;void 0!==child2Path&&refs2.add(child2Path);const iteratorName=children[1].children[0].value;var nonLocalRefs2=Array.from(refs2).filter(x=>!(x===iteratorName||x.startsWith(iteratorName+".")||x.startsWith(iteratorName+"[")));refs=new Set([...refs,...refs0,...nonLocalRefs2])}else for(const child of expression.children){const result=this.referenceWalk(child,extension),childPath=result.path,refs0=result.refs;refs=new Set([...refs,...refs0]),void 0!==childPath&&refs.add(childPath)}}return{path:path,refs:refs}}static parse(expression,lookup){return new parser_1.ExpressionParser(lookup||Expression.lookup).parse(expression)}static lookup(functionName){const exprEvaluator=Expression.functions.get(functionName);if(exprEvaluator)return exprEvaluator}static makeExpression(type,evaluator,...children){const expr=new Expression(type,evaluator,...children);return expr.validate(),expr}static lambaExpression(func){return new Expression(expressionType_1.ExpressionType.Lambda,new expressionEvaluator_1.ExpressionEvaluator(expressionType_1.ExpressionType.Lambda,func))}static lambda(func){return new Expression(expressionType_1.ExpressionType.Lambda,new expressionEvaluator_1.ExpressionEvaluator(expressionType_1.ExpressionType.Lambda,(_expression,state,_)=>{let value,error;try{value=func(state)}catch(funcError){error=funcError}return{value:value,error:error}}))}static setPathToValue(property,value){return value instanceof Expression?Expression.makeExpression(expressionType_1.ExpressionType.SetPathToValue,void 0,property,value):Expression.makeExpression(expressionType_1.ExpressionType.SetPathToValue,void 0,property,new constant_1.Constant(value))}static equalsExpression(...children){return Expression.makeExpression(expressionType_1.ExpressionType.Equal,void 0,...children)}static andExpression(...children){return children.length>1?Expression.makeExpression(expressionType_1.ExpressionType.And,void 0,...children):children[0]}static orExpression(...children){return children.length>1?Expression.makeExpression(expressionType_1.ExpressionType.Or,void 0,...children):children[0]}static notExpression(child){return Expression.makeExpression(expressionType_1.ExpressionType.Not,void 0,child)}validateTree(){this.validate();for(const child of this.children)child.validateTree()}tryEvaluate(state,options){return extensions_1.Extensions.isMemoryInterface(state)||(state=memory_1.SimpleObjectMemory.wrap(state)),options=options||new options_1.Options,this.evaluator.tryEvaluate(this,state,options)}toString(){let builder="",valid=!1;if(this.type===expressionType_1.ExpressionType.Accessor&&this.children.length>=1){if(this.children[0]instanceof constant_1.Constant){const prop=this.children[0].value;"string"==typeof prop&&(1===this.children.length?(valid=!0,builder=builder.concat(prop)):2===this.children.length&&(valid=!0,builder=builder.concat(this.children[1].toString(),".",prop)))}}else this.type===expressionType_1.ExpressionType.Element&&2===this.children.length&&(valid=!0,builder=builder.concat(this.children[0].toString(),"[",this.children[1].toString(),"]"));if(!valid){const infix=this.type.length>0&&!new RegExp(/[a-z]/i).test(this.type[0])&&this.children.length>=2;infix||(builder=builder.concat(this.type)),builder=builder.concat("(");let first=!0;for(const child of this.children)first?first=!1:builder=infix?builder.concat(" ",this.type," "):builder.concat(", "),builder=builder.concat(child.toString());builder=builder.concat(")")}return builder}}Expression.functions=new functionTable_1.FunctionTable,exports.Expression=Expression},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionEvaluator.js":
/*!************************************************************************************************!*\
  !*** ../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionEvaluator.js ***!
  \************************************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const expression_1=__webpack_require__(/*! ./expression */"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expression.js");class ExpressionEvaluator{constructor(type,evaluator,returnType=expression_1.ReturnType.Object,validator){this.tryEvaluate=(expression,state,options)=>this._evaluator(expression,state,options),this.validateExpression=expression=>this._validator(expression),this.type=type,this._evaluator=evaluator,this.returnType=returnType,this._validator=validator||(expr=>{})}}exports.ExpressionEvaluator=ExpressionEvaluator},"../adaptivecards-templating/node_modules/adaptive-expressions/lib/expressionFunctions.js":
/*!**************************